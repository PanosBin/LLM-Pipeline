[
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/androidTest/java/com/app/damnvulnerablebank/ExampleInstrumentedTest.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport android.content.Context;\n\nimport androidx.test.platform.app.InstrumentationRegistry;\nimport androidx.test.ext.junit.runners.AndroidJUnit4;\n\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\n\nimport static org.junit.Assert.*;\n\n/**\n * Instrumented test, which will execute on an Android device.\n *\n * @see <a href=\"http://d.android.com/tools/testing\">Testing documentation</a>\n */\n@RunWith(AndroidJUnit4.class)\npublic class ExampleInstrumentedTest {\n    @Test\n    public void useAppContext() {\n        // Context of the app under test.\n        Context appContext = InstrumentationRegistry.getInstrumentation().getTargetContext();\n        assertEquals(\"com.app.damnvulnerablebank\", appContext.getPackageName());\n    }\n}",
    "classes": [
      {
        "parent_file": null,
        "name": "ExampleInstrumentedTest",
        "position": {
          "start_line": 18,
          "end_line": 26,
          "start_column": 0,
          "end_column": 1
        },
        "code": "@RunWith(AndroidJUnit4.class)\npublic class ExampleInstrumentedTest {\n    @Test\n    public void useAppContext() {\n        // Context of the app under test.\n        Context appContext = InstrumentationRegistry.getInstrumentation().getTargetContext();\n        assertEquals(\"com.app.damnvulnerablebank\", appContext.getPackageName());\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "useAppContext",
            "return_type": "void",
            "position": {
              "start_line": 20,
              "end_line": 25,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Test\n    public void useAppContext() {\n        // Context of the app under test.\n        Context appContext = InstrumentationRegistry.getInstrumentation().getTargetContext();\n        assertEquals(\"com.app.damnvulnerablebank\", appContext.getPackageName());\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/test/java/com/app/damnvulnerablebank/ExampleUnitTest.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport org.junit.Test;\n\nimport static org.junit.Assert.*;\n\n/**\n * Example local unit test, which will execute on the development machine (host).\n *\n * @see <a href=\"http://d.android.com/tools/testing\">Testing documentation</a>\n */\npublic class ExampleUnitTest {\n    @Test\n    public void addition_isCorrect() {\n        assertEquals(4, 2 + 2);\n    }\n}",
    "classes": [
      {
        "parent_file": null,
        "name": "ExampleUnitTest",
        "position": {
          "start_line": 12,
          "end_line": 17,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class ExampleUnitTest {\n    @Test\n    public void addition_isCorrect() {\n        assertEquals(4, 2 + 2);\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "addition_isCorrect",
            "return_type": "void",
            "position": {
              "start_line": 13,
              "end_line": 16,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Test\n    public void addition_isCorrect() {\n        assertEquals(4, 2 + 2);\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/ViewBeneficiary.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport androidx.appcompat.app.AppCompatActivity;\nimport androidx.recyclerview.widget.LinearLayoutManager;\nimport androidx.recyclerview.widget.RecyclerView;\n\nimport android.content.Context;\nimport android.content.SharedPreferences;\nimport android.os.Bundle;\nimport android.view.View;\nimport android.widget.TextView;\nimport android.widget.Toast;\n\nimport com.android.volley.AuthFailureError;\nimport com.android.volley.Request;\nimport com.android.volley.RequestQueue;\nimport com.android.volley.Response;\nimport com.android.volley.VolleyError;\nimport com.android.volley.toolbox.JsonObjectRequest;\nimport com.android.volley.toolbox.Volley;\n\nimport org.json.JSONArray;\nimport org.json.JSONException;\nimport org.json.JSONObject;\n\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\npublic class ViewBeneficiary extends AppCompatActivity  implements Badapter.OnItemClickListener {\n    public static final String beneficiary_account_number=\"beneficiary_account_number\";\n    RecyclerView recyclerView;\n    List<BeneficiaryRecords> brecords;\n    Badapter badapter;\n    private TextView emptyView;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_viewbenif);\n        recyclerView=findViewById(R.id.benif);\n        emptyView = findViewById(R.id.empty_view);\n        brecords=new ArrayList<>();\n        viewBeneficiaries();\n    }\n    public void viewBeneficiaries(){\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint = \"/api/beneficiary/view\";\n        final String finalUrl = url+endpoint;\n        RequestQueue queue = Volley.newRequestQueue(this);\n        JsonObjectRequest jsonArrayRequest=new JsonObjectRequest(Request.Method.POST, finalUrl, null,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONArray jsonArray = decryptedResponse.getJSONArray(\"data\");\n                            for(int i=0; i < jsonArray.length(); i++) {\n                                JSONObject transrecobject = jsonArray.getJSONObject(i);\n                                BeneficiaryRecords brecorder = new BeneficiaryRecords();\n                                brecorder.setBeneficiaryAccount(transrecobject.getString(\"beneficiary_account_number\").toString());\n                                brecorder.setIsApproved(transrecobject.getString(\"approved\").toString());\n                                brecords.add(brecorder);\n                            }\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n                        recyclerView.setLayoutManager(new LinearLayoutManager(getApplicationContext()));\n                        badapter=new Badapter(getApplicationContext(),brecords);\n                        recyclerView.setAdapter(badapter);\n\n                        Integer count=badapter.getItemCount();\n                        if (count == 0) {\n                            recyclerView.setVisibility(View.GONE);\n                            emptyView.setVisibility(View.VISIBLE);\n                        }\n                        else {\n                            recyclerView.setVisibility(View.VISIBLE);\n                            emptyView.setVisibility(View.GONE);\n                        }\n                        badapter.setOnItemClickListener(ViewBeneficiary.this);\n                    }\n\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers = new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }};\n\n        queue.add(jsonArrayRequest);\n        queue.getCache().clear();\n    }\n\n    @Override\n    public void onItemClick(int position) {\n\n    }\n}",
    "classes": [
      {
        "parent_file": null,
        "name": "ViewBeneficiary",
        "position": {
          "start_line": 31,
          "end_line": 120,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class ViewBeneficiary extends AppCompatActivity  implements Badapter.OnItemClickListener {\n    public static final String beneficiary_account_number=\"beneficiary_account_number\";\n    RecyclerView recyclerView;\n    List<BeneficiaryRecords> brecords;\n    Badapter badapter;\n    private TextView emptyView;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_viewbenif);\n        recyclerView=findViewById(R.id.benif);\n        emptyView = findViewById(R.id.empty_view);\n        brecords=new ArrayList<>();\n        viewBeneficiaries();\n    }\n    public void viewBeneficiaries(){\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint = \"/api/beneficiary/view\";\n        final String finalUrl = url+endpoint;\n        RequestQueue queue = Volley.newRequestQueue(this);\n        JsonObjectRequest jsonArrayRequest=new JsonObjectRequest(Request.Method.POST, finalUrl, null,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONArray jsonArray = decryptedResponse.getJSONArray(\"data\");\n                            for(int i=0; i < jsonArray.length(); i++) {\n                                JSONObject transrecobject = jsonArray.getJSONObject(i);\n                                BeneficiaryRecords brecorder = new BeneficiaryRecords();\n                                brecorder.setBeneficiaryAccount(transrecobject.getString(\"beneficiary_account_number\").toString());\n                                brecorder.setIsApproved(transrecobject.getString(\"approved\").toString());\n                                brecords.add(brecorder);\n                            }\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n                        recyclerView.setLayoutManager(new LinearLayoutManager(getApplicationContext()));\n                        badapter=new Badapter(getApplicationContext(),brecords);\n                        recyclerView.setAdapter(badapter);\n\n                        Integer count=badapter.getItemCount();\n                        if (count == 0) {\n                            recyclerView.setVisibility(View.GONE);\n                            emptyView.setVisibility(View.VISIBLE);\n                        }\n                        else {\n                            recyclerView.setVisibility(View.VISIBLE);\n                            emptyView.setVisibility(View.GONE);\n                        }\n                        badapter.setOnItemClickListener(ViewBeneficiary.this);\n                    }\n\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers = new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }};\n\n        queue.add(jsonArrayRequest);\n        queue.getCache().clear();\n    }\n\n    @Override\n    public void onItemClick(int position) {\n\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "onCreate",
            "return_type": "void",
            "position": {
              "start_line": 38,
              "end_line": 46,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_viewbenif);\n        recyclerView=findViewById(R.id.benif);\n        emptyView = findViewById(R.id.empty_view);\n        brecords=new ArrayList<>();\n        viewBeneficiaries();\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "viewBeneficiaries",
            "return_type": "void",
            "position": {
              "start_line": 47,
              "end_line": 114,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void viewBeneficiaries(){\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint = \"/api/beneficiary/view\";\n        final String finalUrl = url+endpoint;\n        RequestQueue queue = Volley.newRequestQueue(this);\n        JsonObjectRequest jsonArrayRequest=new JsonObjectRequest(Request.Method.POST, finalUrl, null,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONArray jsonArray = decryptedResponse.getJSONArray(\"data\");\n                            for(int i=0; i < jsonArray.length(); i++) {\n                                JSONObject transrecobject = jsonArray.getJSONObject(i);\n                                BeneficiaryRecords brecorder = new BeneficiaryRecords();\n                                brecorder.setBeneficiaryAccount(transrecobject.getString(\"beneficiary_account_number\").toString());\n                                brecorder.setIsApproved(transrecobject.getString(\"approved\").toString());\n                                brecords.add(brecorder);\n                            }\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n                        recyclerView.setLayoutManager(new LinearLayoutManager(getApplicationContext()));\n                        badapter=new Badapter(getApplicationContext(),brecords);\n                        recyclerView.setAdapter(badapter);\n\n                        Integer count=badapter.getItemCount();\n                        if (count == 0) {\n                            recyclerView.setVisibility(View.GONE);\n                            emptyView.setVisibility(View.VISIBLE);\n                        }\n                        else {\n                            recyclerView.setVisibility(View.VISIBLE);\n                            emptyView.setVisibility(View.GONE);\n                        }\n                        badapter.setOnItemClickListener(ViewBeneficiary.this);\n                    }\n\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers = new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }};\n\n        queue.add(jsonArrayRequest);\n        queue.getCache().clear();\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onResponse",
            "return_type": "void",
            "position": {
              "start_line": 55,
              "end_line": 95,
              "start_column": 20,
              "end_column": 21
            },
            "code": "@Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONArray jsonArray = decryptedResponse.getJSONArray(\"data\");\n                            for(int i=0; i < jsonArray.length(); i++) {\n                                JSONObject transrecobject = jsonArray.getJSONObject(i);\n                                BeneficiaryRecords brecorder = new BeneficiaryRecords();\n                                brecorder.setBeneficiaryAccount(transrecobject.getString(\"beneficiary_account_number\").toString());\n                                brecorder.setIsApproved(transrecobject.getString(\"approved\").toString());\n                                brecords.add(brecorder);\n                            }\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n                        recyclerView.setLayoutManager(new LinearLayoutManager(getApplicationContext()));\n                        badapter=new Badapter(getApplicationContext(),brecords);\n                        recyclerView.setAdapter(badapter);\n\n                        Integer count=badapter.getItemCount();\n                        if (count == 0) {\n                            recyclerView.setVisibility(View.GONE);\n                            emptyView.setVisibility(View.VISIBLE);\n                        }\n                        else {\n                            recyclerView.setVisibility(View.VISIBLE);\n                            emptyView.setVisibility(View.GONE);\n                        }\n                        badapter.setOnItemClickListener(ViewBeneficiary.this);\n                    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onErrorResponse",
            "return_type": "void",
            "position": {
              "start_line": 98,
              "end_line": 101,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getHeaders",
            "return_type": "Map",
            "position": {
              "start_line": 103,
              "end_line": 110,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers = new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onItemClick",
            "return_type": "void",
            "position": {
              "start_line": 116,
              "end_line": 119,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    public void onItemClick(int position) {\n\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/Padapter.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport android.content.Context;\nimport android.view.LayoutInflater;\nimport android.view.View;\nimport android.view.ViewGroup;\nimport android.widget.TextView;\n\nimport androidx.annotation.NonNull;\nimport androidx.recyclerview.widget.RecyclerView;\n\nimport java.util.List;\n\npublic class Padapter extends RecyclerView.Adapter<Padapter.ViewHolder>{\n    LayoutInflater inflater;\n    List<PendingBeneficiaryRecords> precords;\n    private Padapter.OnItemClickListener mListener;\n\n    public interface OnItemClickListener{\n        void onItemClick(int position);\n    }\n\n    public void setOnItemClickListener(Padapter.OnItemClickListener listener){\n        mListener =listener;\n    }\n\n    public Padapter(Context ctx,List<PendingBeneficiaryRecords> precords){\n        this.inflater=LayoutInflater.from(ctx);\n        this.precords=precords;\n    }\n\n    @NonNull\n    @Override\n    public Padapter.ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\n        View view =inflater.inflate(R.layout.custom_pend,parent,false);\n        return  new ViewHolder(view);\n    }\n\n    @Override\n    public void onBindViewHolder(@NonNull Padapter.ViewHolder holder, int position) {\n        holder.account_number.setText(precords.get(position).getAccountNumber());\n        holder.beneficiary_account_number.setText(precords.get(position).getBeneficiaryAccountNumber());\n        holder.idd.setText(precords.get(position).getId());\n\n    }\n\n    @Override\n    public int getItemCount() {\n        return precords.size();\n    }\n\n    public class ViewHolder extends  RecyclerView.ViewHolder{\n        TextView account_number,beneficiary_account_number,idd;\n\n        public ViewHolder(@NonNull View itemView) {\n            super(itemView);\n\n            account_number=itemView.findViewById(R.id.accno);\n            beneficiary_account_number=itemView.findViewById(R.id.beacc);\n            idd=itemView.findViewById(R.id.idn);\n\n            itemView.setOnClickListener(new View.OnClickListener() {\n                @Override\n                public void onClick(View v) {\n                    if(mListener != null){\n                        int position =getAdapterPosition();\n                        if(position !=RecyclerView.NO_POSITION){\n                            mListener.onItemClick(position);\n                        }\n                    }\n                }\n            });\n\n        }\n    }\n}\n\n",
    "classes": [
      {
        "parent_file": null,
        "name": "Padapter",
        "position": {
          "start_line": 14,
          "end_line": 76,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class Padapter extends RecyclerView.Adapter<Padapter.ViewHolder>{\n    LayoutInflater inflater;\n    List<PendingBeneficiaryRecords> precords;\n    private Padapter.OnItemClickListener mListener;\n\n    public interface OnItemClickListener{\n        void onItemClick(int position);\n    }\n\n    public void setOnItemClickListener(Padapter.OnItemClickListener listener){\n        mListener =listener;\n    }\n\n    public Padapter(Context ctx,List<PendingBeneficiaryRecords> precords){\n        this.inflater=LayoutInflater.from(ctx);\n        this.precords=precords;\n    }\n\n    @NonNull\n    @Override\n    public Padapter.ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\n        View view =inflater.inflate(R.layout.custom_pend,parent,false);\n        return  new ViewHolder(view);\n    }\n\n    @Override\n    public void onBindViewHolder(@NonNull Padapter.ViewHolder holder, int position) {\n        holder.account_number.setText(precords.get(position).getAccountNumber());\n        holder.beneficiary_account_number.setText(precords.get(position).getBeneficiaryAccountNumber());\n        holder.idd.setText(precords.get(position).getId());\n\n    }\n\n    @Override\n    public int getItemCount() {\n        return precords.size();\n    }\n\n    public class ViewHolder extends  RecyclerView.ViewHolder{\n        TextView account_number,beneficiary_account_number,idd;\n\n        public ViewHolder(@NonNull View itemView) {\n            super(itemView);\n\n            account_number=itemView.findViewById(R.id.accno);\n            beneficiary_account_number=itemView.findViewById(R.id.beacc);\n            idd=itemView.findViewById(R.id.idn);\n\n            itemView.setOnClickListener(new View.OnClickListener() {\n                @Override\n                public void onClick(View v) {\n                    if(mListener != null){\n                        int position =getAdapterPosition();\n                        if(position !=RecyclerView.NO_POSITION){\n                            mListener.onItemClick(position);\n                        }\n                    }\n                }\n            });\n\n        }\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "onItemClick",
            "return_type": "void",
            "position": {
              "start_line": 20,
              "end_line": 20,
              "start_column": 8,
              "end_column": 39
            },
            "code": "void onItemClick(int position);",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "setOnItemClickListener",
            "return_type": "void",
            "position": {
              "start_line": 23,
              "end_line": 25,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void setOnItemClickListener(Padapter.OnItemClickListener listener){\n        mListener =listener;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onCreateViewHolder",
            "return_type": "Padapter.ViewHolder",
            "position": {
              "start_line": 32,
              "end_line": 37,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@NonNull\n    @Override\n    public Padapter.ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\n        View view =inflater.inflate(R.layout.custom_pend,parent,false);\n        return  new ViewHolder(view);\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onBindViewHolder",
            "return_type": "void",
            "position": {
              "start_line": 39,
              "end_line": 45,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    public void onBindViewHolder(@NonNull Padapter.ViewHolder holder, int position) {\n        holder.account_number.setText(precords.get(position).getAccountNumber());\n        holder.beneficiary_account_number.setText(precords.get(position).getBeneficiaryAccountNumber());\n        holder.idd.setText(precords.get(position).getId());\n\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getItemCount",
            "return_type": "int",
            "position": {
              "start_line": 47,
              "end_line": 50,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    public int getItemCount() {\n        return precords.size();\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onClick",
            "return_type": "void",
            "position": {
              "start_line": 63,
              "end_line": 71,
              "start_column": 16,
              "end_column": 17
            },
            "code": "@Override\n                public void onClick(View v) {\n                    if(mListener != null){\n                        int position =getAdapterPosition();\n                        if(position !=RecyclerView.NO_POSITION){\n                            mListener.onItemClick(position);\n                        }\n                    }\n                }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      },
      {
        "parent_file": null,
        "name": "ViewHolder",
        "position": {
          "start_line": 52,
          "end_line": 75,
          "start_column": 4,
          "end_column": 5
        },
        "code": "public class ViewHolder extends  RecyclerView.ViewHolder{\n        TextView account_number,beneficiary_account_number,idd;\n\n        public ViewHolder(@NonNull View itemView) {\n            super(itemView);\n\n            account_number=itemView.findViewById(R.id.accno);\n            beneficiary_account_number=itemView.findViewById(R.id.beacc);\n            idd=itemView.findViewById(R.id.idn);\n\n            itemView.setOnClickListener(new View.OnClickListener() {\n                @Override\n                public void onClick(View v) {\n                    if(mListener != null){\n                        int position =getAdapterPosition();\n                        if(position !=RecyclerView.NO_POSITION){\n                            mListener.onItemClick(position);\n                        }\n                    }\n                }\n            });\n\n        }\n    }",
        "summary": "",
        "methods": [
          {
            "name": "onClick",
            "return_type": "void",
            "position": {
              "start_line": 63,
              "end_line": 71,
              "start_column": 16,
              "end_column": 17
            },
            "code": "@Override\n                public void onClick(View v) {\n                    if(mListener != null){\n                        int position =getAdapterPosition();\n                        if(position !=RecyclerView.NO_POSITION){\n                            mListener.onItemClick(position);\n                        }\n                    }\n                }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/TransactionRecords.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport android.widget.ImageView;\n\npublic class TransactionRecords {\n    private String fromaccnt;\n    private  String toaccnt;\n    private  String amount;\n\n\n    public TransactionRecords(){}\n    public TransactionRecords(String fromacc, String toacc, String amount){\n        this.fromaccnt=fromacc;\n        this.toaccnt=toacc;\n        this.amount=amount;\n    }\n\n    public String getFromaccnt() {\n        return fromaccnt;\n    }\n\n    public void setFromaccnt(String fromaccnt) {\n        this.fromaccnt = \"From Account Number\\t\\t:\"+fromaccnt;\n    }\n\n    public String getToaccnt() {\n        return toaccnt;\n    }\n\n    public void setToaccnt(String toaccnt) {\n        this.toaccnt = \"To    Account Number\\t\\t:\"+toaccnt;\n    }\n\n    public String getAmount() {\n        return amount;\n    }\n\n    public void setAmount(String amount) {\n        this.amount = \"Amount Sent\\t\\t:$\"+amount;\n    }\n\n}\n\n\n\n",
    "classes": [
      {
        "parent_file": null,
        "name": "TransactionRecords",
        "position": {
          "start_line": 5,
          "end_line": 42,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class TransactionRecords {\n    private String fromaccnt;\n    private  String toaccnt;\n    private  String amount;\n\n\n    public TransactionRecords(){}\n    public TransactionRecords(String fromacc, String toacc, String amount){\n        this.fromaccnt=fromacc;\n        this.toaccnt=toacc;\n        this.amount=amount;\n    }\n\n    public String getFromaccnt() {\n        return fromaccnt;\n    }\n\n    public void setFromaccnt(String fromaccnt) {\n        this.fromaccnt = \"From Account Number\\t\\t:\"+fromaccnt;\n    }\n\n    public String getToaccnt() {\n        return toaccnt;\n    }\n\n    public void setToaccnt(String toaccnt) {\n        this.toaccnt = \"To    Account Number\\t\\t:\"+toaccnt;\n    }\n\n    public String getAmount() {\n        return amount;\n    }\n\n    public void setAmount(String amount) {\n        this.amount = \"Amount Sent\\t\\t:$\"+amount;\n    }\n\n}",
        "summary": "",
        "methods": [
          {
            "name": "getFromaccnt",
            "return_type": "String",
            "position": {
              "start_line": 18,
              "end_line": 20,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public String getFromaccnt() {\n        return fromaccnt;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "setFromaccnt",
            "return_type": "void",
            "position": {
              "start_line": 22,
              "end_line": 24,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void setFromaccnt(String fromaccnt) {\n        this.fromaccnt = \"From Account Number\\t\\t:\"+fromaccnt;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getToaccnt",
            "return_type": "String",
            "position": {
              "start_line": 26,
              "end_line": 28,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public String getToaccnt() {\n        return toaccnt;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "setToaccnt",
            "return_type": "void",
            "position": {
              "start_line": 30,
              "end_line": 32,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void setToaccnt(String toaccnt) {\n        this.toaccnt = \"To    Account Number\\t\\t:\"+toaccnt;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getAmount",
            "return_type": "String",
            "position": {
              "start_line": 34,
              "end_line": 36,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public String getAmount() {\n        return amount;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "setAmount",
            "return_type": "void",
            "position": {
              "start_line": 38,
              "end_line": 40,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void setAmount(String amount) {\n        this.amount = \"Amount Sent\\t\\t:$\"+amount;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/Myprofile.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport android.content.Context;\nimport android.content.SharedPreferences;\nimport android.graphics.Typeface;\nimport android.os.Bundle;\nimport android.widget.TextView;\nimport android.widget.Toast;\n\nimport com.android.volley.AuthFailureError;\nimport com.android.volley.Request;\nimport com.android.volley.RequestQueue;\nimport com.android.volley.Response;\nimport com.android.volley.VolleyError;\nimport com.android.volley.toolbox.JsonObjectRequest;\nimport com.android.volley.toolbox.Volley;\n\nimport org.json.JSONException;\nimport org.json.JSONObject;\n\nimport java.util.HashMap;\nimport java.util.Map;\n\npublic class Myprofile extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_myprofile);\n        final TextView tv1=findViewById(R.id.textView1);\n//        tv1.setTypeface(null, Typeface.BOLD_ITALIC);\n        final TextView tv2=findViewById(R.id.textView2);\n        final TextView tv3=findViewById(R.id.textView3);\n        final TextView tv4=findViewById(R.id.textView4);\n        SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n        final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n        final RequestQueue queue = Volley.newRequestQueue(this);\n        sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint=\"/api/user/profile\";\n        String finalurl = url+endpoint;\n\n\n\n        final JsonObjectRequest stringRequest = new JsonObjectRequest(Request.Method.POST, finalurl,null,\n                new Response.Listener<JSONObject>()  {\n                    @Override\n                    public void onResponse(JSONObject response) {\n                        try {\n\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONObject obj = decryptedResponse.getJSONObject(\"data\");\n                            String balance=obj.getString(\"balance\");\n                            String account_number =obj.getString(\"account_number\");\n                            String username =obj.getString(\"username\");\n                            String is_admin =obj.getString(\"is_admin\");\n                            tv1.setText(\"Name:\\t\\t\" + username);\n                            tv2.setText(\"Account Number:\\t\\t\" + account_number);\n                            tv3.setText(\"Balance:\\t\\t$\" +balance);\n                            if(is_admin == \"true\") {\n                                tv4.setText(\"Admin:\\t\\tYes\");\n                            } else {\n                                tv4.setText(\"Admin:\\t\\tNo\");\n                            }\n\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }\n\n\n        };\n\n\n\n\n\n        queue.add(stringRequest);\n        queue.getCache().clear();\n    }\n}",
    "classes": [
      {
        "parent_file": null,
        "name": "Myprofile",
        "position": {
          "start_line": 26,
          "end_line": 104,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class Myprofile extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_myprofile);\n        final TextView tv1=findViewById(R.id.textView1);\n//        tv1.setTypeface(null, Typeface.BOLD_ITALIC);\n        final TextView tv2=findViewById(R.id.textView2);\n        final TextView tv3=findViewById(R.id.textView3);\n        final TextView tv4=findViewById(R.id.textView4);\n        SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n        final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n        final RequestQueue queue = Volley.newRequestQueue(this);\n        sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint=\"/api/user/profile\";\n        String finalurl = url+endpoint;\n\n\n\n        final JsonObjectRequest stringRequest = new JsonObjectRequest(Request.Method.POST, finalurl,null,\n                new Response.Listener<JSONObject>()  {\n                    @Override\n                    public void onResponse(JSONObject response) {\n                        try {\n\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONObject obj = decryptedResponse.getJSONObject(\"data\");\n                            String balance=obj.getString(\"balance\");\n                            String account_number =obj.getString(\"account_number\");\n                            String username =obj.getString(\"username\");\n                            String is_admin =obj.getString(\"is_admin\");\n                            tv1.setText(\"Name:\\t\\t\" + username);\n                            tv2.setText(\"Account Number:\\t\\t\" + account_number);\n                            tv3.setText(\"Balance:\\t\\t$\" +balance);\n                            if(is_admin == \"true\") {\n                                tv4.setText(\"Admin:\\t\\tYes\");\n                            } else {\n                                tv4.setText(\"Admin:\\t\\tNo\");\n                            }\n\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }\n\n\n        };\n\n\n\n\n\n        queue.add(stringRequest);\n        queue.getCache().clear();\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "onCreate",
            "return_type": "void",
            "position": {
              "start_line": 28,
              "end_line": 103,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_myprofile);\n        final TextView tv1=findViewById(R.id.textView1);\n//        tv1.setTypeface(null, Typeface.BOLD_ITALIC);\n        final TextView tv2=findViewById(R.id.textView2);\n        final TextView tv3=findViewById(R.id.textView3);\n        final TextView tv4=findViewById(R.id.textView4);\n        SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n        final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n        final RequestQueue queue = Volley.newRequestQueue(this);\n        sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint=\"/api/user/profile\";\n        String finalurl = url+endpoint;\n\n\n\n        final JsonObjectRequest stringRequest = new JsonObjectRequest(Request.Method.POST, finalurl,null,\n                new Response.Listener<JSONObject>()  {\n                    @Override\n                    public void onResponse(JSONObject response) {\n                        try {\n\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONObject obj = decryptedResponse.getJSONObject(\"data\");\n                            String balance=obj.getString(\"balance\");\n                            String account_number =obj.getString(\"account_number\");\n                            String username =obj.getString(\"username\");\n                            String is_admin =obj.getString(\"is_admin\");\n                            tv1.setText(\"Name:\\t\\t\" + username);\n                            tv2.setText(\"Account Number:\\t\\t\" + account_number);\n                            tv3.setText(\"Balance:\\t\\t$\" +balance);\n                            if(is_admin == \"true\") {\n                                tv4.setText(\"Admin:\\t\\tYes\");\n                            } else {\n                                tv4.setText(\"Admin:\\t\\tNo\");\n                            }\n\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }\n\n\n        };\n\n\n\n\n\n        queue.add(stringRequest);\n        queue.getCache().clear();\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onResponse",
            "return_type": "void",
            "position": {
              "start_line": 49,
              "end_line": 80,
              "start_column": 20,
              "end_column": 21
            },
            "code": "@Override\n                    public void onResponse(JSONObject response) {\n                        try {\n\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONObject obj = decryptedResponse.getJSONObject(\"data\");\n                            String balance=obj.getString(\"balance\");\n                            String account_number =obj.getString(\"account_number\");\n                            String username =obj.getString(\"username\");\n                            String is_admin =obj.getString(\"is_admin\");\n                            tv1.setText(\"Name:\\t\\t\" + username);\n                            tv2.setText(\"Account Number:\\t\\t\" + account_number);\n                            tv3.setText(\"Balance:\\t\\t$\" +balance);\n                            if(is_admin == \"true\") {\n                                tv4.setText(\"Admin:\\t\\tYes\");\n                            } else {\n                                tv4.setText(\"Admin:\\t\\tNo\");\n                            }\n\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n                    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onErrorResponse",
            "return_type": "void",
            "position": {
              "start_line": 82,
              "end_line": 85,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public void onErrorResponse(VolleyError error) {\n\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getHeaders",
            "return_type": "Map",
            "position": {
              "start_line": 87,
              "end_line": 92,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public Map getHeaders() throws AuthFailureError {\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/ApproveBeneficiary.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport android.content.Context;\nimport android.content.Intent;\nimport android.content.SharedPreferences;\nimport android.os.Bundle;\nimport android.view.View;\nimport android.widget.EditText;\nimport android.widget.TextView;\nimport android.widget.Toast;\n\nimport com.android.volley.AuthFailureError;\nimport com.android.volley.Request;\nimport com.android.volley.RequestQueue;\nimport com.android.volley.Response;\nimport com.android.volley.VolleyError;\nimport com.android.volley.toolbox.JsonObjectRequest;\nimport com.android.volley.toolbox.Volley;\n\nimport org.json.JSONException;\nimport org.json.JSONObject;\n\nimport java.util.HashMap;\nimport java.util.Map;\n\npublic class ApproveBeneficiary extends AppCompatActivity {\n    TextView hey;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_approvebenificiary);\n        hey=findViewById(R.id.accountid);\n        Intent i =getIntent();\n        String we=i.getStringExtra(\"id\");\n        hey.setText(we);\n    }\n\n public void approveBeneficiary(View view){\n     SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n     final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n     EditText ed=findViewById(R.id.accountid1);\n     int n = Integer.parseInt(ed.getText().toString());\n\n     final RequestQueue requestQueue = Volley.newRequestQueue(getApplicationContext());\n     JSONObject requestData = new JSONObject();\n     JSONObject requestDataEncrypted = new JSONObject();\n     try {\n         //input your API parameters\n         requestData.put(\"id\",n);\n\n         // Encrypt data before sending\n         requestDataEncrypted.put(\"enc_data\", EncryptDecrypt.encrypt(requestData.toString()));\n\n     } catch (JSONException e) {\n         e.printStackTrace();\n     }\n     // Enter the correct url for your api service site\n     sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n     final String url  = sharedPreferences.getString(\"apiurl\",null);\n     String endpoint=\"/api/beneficiary/approve\";\n     String finalurl = url+endpoint;\n     final JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(Request.Method.POST, finalurl, requestDataEncrypted,\n             new Response.Listener<JSONObject>() {\n                 @Override\n                 public void onResponse(JSONObject response) {\n\n\n                     try {\n                         Toast.makeText(getApplicationContext(),\"\"+EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()), Toast.LENGTH_SHORT).show();\n                     } catch (JSONException e) {\n                         e.printStackTrace();\n                     }\n\n\n                     startActivity(new Intent(ApproveBeneficiary.this, Dashboard.class));\n\n                 }\n             }, new Response.ErrorListener() {\n         @Override\n         public void onErrorResponse(VolleyError error) {\n             Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n         }\n     }){\n         @Override\n         public Map getHeaders() throws AuthFailureError {\n             HashMap headers=new HashMap();\n             headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n             return headers;\n         }\n\n\n     };\n     requestQueue.add(jsonObjectRequest);\n }\n\n}",
    "classes": [
      {
        "parent_file": null,
        "name": "ApproveBeneficiary",
        "position": {
          "start_line": 28,
          "end_line": 99,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class ApproveBeneficiary extends AppCompatActivity {\n    TextView hey;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_approvebenificiary);\n        hey=findViewById(R.id.accountid);\n        Intent i =getIntent();\n        String we=i.getStringExtra(\"id\");\n        hey.setText(we);\n    }\n\n public void approveBeneficiary(View view){\n     SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n     final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n     EditText ed=findViewById(R.id.accountid1);\n     int n = Integer.parseInt(ed.getText().toString());\n\n     final RequestQueue requestQueue = Volley.newRequestQueue(getApplicationContext());\n     JSONObject requestData = new JSONObject();\n     JSONObject requestDataEncrypted = new JSONObject();\n     try {\n         //input your API parameters\n         requestData.put(\"id\",n);\n\n         // Encrypt data before sending\n         requestDataEncrypted.put(\"enc_data\", EncryptDecrypt.encrypt(requestData.toString()));\n\n     } catch (JSONException e) {\n         e.printStackTrace();\n     }\n     // Enter the correct url for your api service site\n     sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n     final String url  = sharedPreferences.getString(\"apiurl\",null);\n     String endpoint=\"/api/beneficiary/approve\";\n     String finalurl = url+endpoint;\n     final JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(Request.Method.POST, finalurl, requestDataEncrypted,\n             new Response.Listener<JSONObject>() {\n                 @Override\n                 public void onResponse(JSONObject response) {\n\n\n                     try {\n                         Toast.makeText(getApplicationContext(),\"\"+EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()), Toast.LENGTH_SHORT).show();\n                     } catch (JSONException e) {\n                         e.printStackTrace();\n                     }\n\n\n                     startActivity(new Intent(ApproveBeneficiary.this, Dashboard.class));\n\n                 }\n             }, new Response.ErrorListener() {\n         @Override\n         public void onErrorResponse(VolleyError error) {\n             Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n         }\n     }){\n         @Override\n         public Map getHeaders() throws AuthFailureError {\n             HashMap headers=new HashMap();\n             headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n             return headers;\n         }\n\n\n     };\n     requestQueue.add(jsonObjectRequest);\n }\n\n}",
        "summary": "",
        "methods": [
          {
            "name": "onCreate",
            "return_type": "void",
            "position": {
              "start_line": 31,
              "end_line": 39,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_approvebenificiary);\n        hey=findViewById(R.id.accountid);\n        Intent i =getIntent();\n        String we=i.getStringExtra(\"id\");\n        hey.setText(we);\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "approveBeneficiary",
            "return_type": "void",
            "position": {
              "start_line": 41,
              "end_line": 97,
              "start_column": 1,
              "end_column": 2
            },
            "code": "public void approveBeneficiary(View view){\n     SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n     final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n     EditText ed=findViewById(R.id.accountid1);\n     int n = Integer.parseInt(ed.getText().toString());\n\n     final RequestQueue requestQueue = Volley.newRequestQueue(getApplicationContext());\n     JSONObject requestData = new JSONObject();\n     JSONObject requestDataEncrypted = new JSONObject();\n     try {\n         //input your API parameters\n         requestData.put(\"id\",n);\n\n         // Encrypt data before sending\n         requestDataEncrypted.put(\"enc_data\", EncryptDecrypt.encrypt(requestData.toString()));\n\n     } catch (JSONException e) {\n         e.printStackTrace();\n     }\n     // Enter the correct url for your api service site\n     sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n     final String url  = sharedPreferences.getString(\"apiurl\",null);\n     String endpoint=\"/api/beneficiary/approve\";\n     String finalurl = url+endpoint;\n     final JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(Request.Method.POST, finalurl, requestDataEncrypted,\n             new Response.Listener<JSONObject>() {\n                 @Override\n                 public void onResponse(JSONObject response) {\n\n\n                     try {\n                         Toast.makeText(getApplicationContext(),\"\"+EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()), Toast.LENGTH_SHORT).show();\n                     } catch (JSONException e) {\n                         e.printStackTrace();\n                     }\n\n\n                     startActivity(new Intent(ApproveBeneficiary.this, Dashboard.class));\n\n                 }\n             }, new Response.ErrorListener() {\n         @Override\n         public void onErrorResponse(VolleyError error) {\n             Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n         }\n     }){\n         @Override\n         public Map getHeaders() throws AuthFailureError {\n             HashMap headers=new HashMap();\n             headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n             return headers;\n         }\n\n\n     };\n     requestQueue.add(jsonObjectRequest);\n }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onResponse",
            "return_type": "void",
            "position": {
              "start_line": 67,
              "end_line": 80,
              "start_column": 17,
              "end_column": 18
            },
            "code": "@Override\n                 public void onResponse(JSONObject response) {\n\n\n                     try {\n                         Toast.makeText(getApplicationContext(),\"\"+EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()), Toast.LENGTH_SHORT).show();\n                     } catch (JSONException e) {\n                         e.printStackTrace();\n                     }\n\n\n                     startActivity(new Intent(ApproveBeneficiary.this, Dashboard.class));\n\n                 }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onErrorResponse",
            "return_type": "void",
            "position": {
              "start_line": 82,
              "end_line": 85,
              "start_column": 9,
              "end_column": 10
            },
            "code": "@Override\n         public void onErrorResponse(VolleyError error) {\n             Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n         }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getHeaders",
            "return_type": "Map",
            "position": {
              "start_line": 87,
              "end_line": 92,
              "start_column": 9,
              "end_column": 10
            },
            "code": "@Override\n         public Map getHeaders() throws AuthFailureError {\n             HashMap headers=new HashMap();\n             headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n             return headers;\n         }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/RootUtil.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport android.content.Context;\nimport android.content.pm.ApplicationInfo;\nimport android.provider.Settings;\n\nimport java.io.BufferedReader;\nimport java.io.File;\nimport java.io.InputStreamReader;\n\npublic class RootUtil {\n\n    public static boolean isDeviceRooted() {\n        return checkRootMethod1() || checkRootMethod2() || checkRootMethod3();\n    }\n\n    private static boolean checkRootMethod1() {\n        String buildTags = android.os.Build.TAGS;\n        return buildTags != null && buildTags.contains(\"test-keys\");\n    }\n\n    /*private static boolean usbdebugcheck(){\n        boolean isDebuggable =  ( 0 != ( getApplicationInfo().flags &= ApplicationInfo.FLAG_DEBUGGABLE ));\n\n        if() {\n            // debugging enabled\n        } else {\n            //;debugging does not enabled\n        }\n    }*/\n\n    private static boolean checkRootMethod2() {\n        String[] paths = { \"/system/app/Superuser.apk\", \"/sbin/su\", \"/system/bin/su\", \"/system/xbin/su\", \"/data/local/xbin/su\", \"/data/local/bin/su\", \"/system/sd/xbin/su\",\n                \"/system/bin/failsafe/su\", \"/data/local/su\", \"/su/bin/su\"};\n        for (String path : paths) {\n            if (new File(path).exists()) return true;\n        }\n        return false;\n    }\n\n    private static boolean checkRootMethod3() {\n        Process process = null;\n        try {\n            process = Runtime.getRuntime().exec(new String[] { \"/system/xbin/which\", \"su\" });\n            BufferedReader in = new BufferedReader(new InputStreamReader(process.getInputStream()));\n            if (in.readLine() != null) return true;\n            return false;\n        } catch (Throwable t) {\n            return false;\n        } finally {\n            if (process != null) process.destroy();\n        }\n    }\n}",
    "classes": [
      {
        "parent_file": null,
        "name": "RootUtil",
        "position": {
          "start_line": 11,
          "end_line": 54,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class RootUtil {\n\n    public static boolean isDeviceRooted() {\n        return checkRootMethod1() || checkRootMethod2() || checkRootMethod3();\n    }\n\n    private static boolean checkRootMethod1() {\n        String buildTags = android.os.Build.TAGS;\n        return buildTags != null && buildTags.contains(\"test-keys\");\n    }\n\n    /*private static boolean usbdebugcheck(){\n        boolean isDebuggable =  ( 0 != ( getApplicationInfo().flags &= ApplicationInfo.FLAG_DEBUGGABLE ));\n\n        if() {\n            // debugging enabled\n        } else {\n            //;debugging does not enabled\n        }\n    }*/\n\n    private static boolean checkRootMethod2() {\n        String[] paths = { \"/system/app/Superuser.apk\", \"/sbin/su\", \"/system/bin/su\", \"/system/xbin/su\", \"/data/local/xbin/su\", \"/data/local/bin/su\", \"/system/sd/xbin/su\",\n                \"/system/bin/failsafe/su\", \"/data/local/su\", \"/su/bin/su\"};\n        for (String path : paths) {\n            if (new File(path).exists()) return true;\n        }\n        return false;\n    }\n\n    private static boolean checkRootMethod3() {\n        Process process = null;\n        try {\n            process = Runtime.getRuntime().exec(new String[] { \"/system/xbin/which\", \"su\" });\n            BufferedReader in = new BufferedReader(new InputStreamReader(process.getInputStream()));\n            if (in.readLine() != null) return true;\n            return false;\n        } catch (Throwable t) {\n            return false;\n        } finally {\n            if (process != null) process.destroy();\n        }\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "isDeviceRooted",
            "return_type": "boolean",
            "position": {
              "start_line": 13,
              "end_line": 15,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public static boolean isDeviceRooted() {\n        return checkRootMethod1() || checkRootMethod2() || checkRootMethod3();\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "checkRootMethod1",
            "return_type": "boolean",
            "position": {
              "start_line": 17,
              "end_line": 20,
              "start_column": 4,
              "end_column": 5
            },
            "code": "private static boolean checkRootMethod1() {\n        String buildTags = android.os.Build.TAGS;\n        return buildTags != null && buildTags.contains(\"test-keys\");\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "checkRootMethod2",
            "return_type": "boolean",
            "position": {
              "start_line": 32,
              "end_line": 39,
              "start_column": 4,
              "end_column": 5
            },
            "code": "private static boolean checkRootMethod2() {\n        String[] paths = { \"/system/app/Superuser.apk\", \"/sbin/su\", \"/system/bin/su\", \"/system/xbin/su\", \"/data/local/xbin/su\", \"/data/local/bin/su\", \"/system/sd/xbin/su\",\n                \"/system/bin/failsafe/su\", \"/data/local/su\", \"/su/bin/su\"};\n        for (String path : paths) {\n            if (new File(path).exists()) return true;\n        }\n        return false;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "checkRootMethod3",
            "return_type": "boolean",
            "position": {
              "start_line": 41,
              "end_line": 53,
              "start_column": 4,
              "end_column": 5
            },
            "code": "private static boolean checkRootMethod3() {\n        Process process = null;\n        try {\n            process = Runtime.getRuntime().exec(new String[] { \"/system/xbin/which\", \"su\" });\n            BufferedReader in = new BufferedReader(new InputStreamReader(process.getInputStream()));\n            if (in.readLine() != null) return true;\n            return false;\n        } catch (Throwable t) {\n            return false;\n        } finally {\n            if (process != null) process.destroy();\n        }\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/ResetPassword.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport android.content.Context;\nimport android.content.Intent;\nimport android.content.SharedPreferences;\nimport android.os.Bundle;\nimport android.view.View;\nimport android.widget.EditText;\nimport android.widget.Toast;\n\nimport com.android.volley.AuthFailureError;\nimport com.android.volley.Request;\nimport com.android.volley.RequestQueue;\nimport com.android.volley.Response;\nimport com.android.volley.VolleyError;\nimport com.android.volley.toolbox.JsonObjectRequest;\nimport com.android.volley.toolbox.Volley;\n\nimport org.json.JSONException;\nimport org.json.JSONObject;\n\nimport java.util.HashMap;\nimport java.util.Map;\n\npublic class ResetPassword extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_passreset);\n    }\n\n    public void resetPassword(View view) {\n        EditText oldPass = findViewById(R.id.oldlogin_password_editText);\n        EditText newPass = findViewById(R.id.newlogin_password_editText);\n        EditText newPassConfirm = findViewById(R.id.new1login_password_editText);\n        final String oldPassword = oldPass.getText().toString().trim();\n        final String newPassword = newPass.getText().toString().trim();\n        final String newpasswordConfirm = newPassConfirm.getText().toString().trim();\n\n        if (!newPassword.equals(newpasswordConfirm)) {\n            Toast.makeText(getApplicationContext(), \"Something Entered Password is Different\", Toast.LENGTH_SHORT).show();\n        }\n\n        else{\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url = sharedPreferences.getString(\"apiurl\", null);\n        String endpoint = \"/api/user/change-password\";\n        String finalurl = url + endpoint;\n\n        final RequestQueue requestQueue = Volley.newRequestQueue(getApplicationContext());\n        JSONObject requestData = new JSONObject();\n        JSONObject requestDataEncrypted = new JSONObject();\n        try {\n            //input your API parameters\n            requestData.put(\"password\", oldPassword);\n            requestData.put(\"new_password\", newPassword);\n\n            // Encrypt data before sending\n            requestDataEncrypted.put(\"enc_data\", EncryptDecrypt.encrypt(requestData.toString()));\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        // Enter the correct url for your api service site\n        final JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(Request.Method.POST, finalurl, requestDataEncrypted,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n\n                        Toast.makeText(getApplicationContext(),\"Done\", Toast.LENGTH_SHORT).show();\n                        SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                        sharedPreferences.edit().putBoolean(\"isloggedin\", false).apply();\n                        startActivity(new Intent(ResetPassword.this, BankLogin.class));\n\n\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \" + retrivedToken);\n                return headers;\n            }};\n\n        requestQueue.add(jsonObjectRequest);\n\n    }\n    }\n}",
    "classes": [
      {
        "parent_file": null,
        "name": "ResetPassword",
        "position": {
          "start_line": 27,
          "end_line": 98,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class ResetPassword extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_passreset);\n    }\n\n    public void resetPassword(View view) {\n        EditText oldPass = findViewById(R.id.oldlogin_password_editText);\n        EditText newPass = findViewById(R.id.newlogin_password_editText);\n        EditText newPassConfirm = findViewById(R.id.new1login_password_editText);\n        final String oldPassword = oldPass.getText().toString().trim();\n        final String newPassword = newPass.getText().toString().trim();\n        final String newpasswordConfirm = newPassConfirm.getText().toString().trim();\n\n        if (!newPassword.equals(newpasswordConfirm)) {\n            Toast.makeText(getApplicationContext(), \"Something Entered Password is Different\", Toast.LENGTH_SHORT).show();\n        }\n\n        else{\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url = sharedPreferences.getString(\"apiurl\", null);\n        String endpoint = \"/api/user/change-password\";\n        String finalurl = url + endpoint;\n\n        final RequestQueue requestQueue = Volley.newRequestQueue(getApplicationContext());\n        JSONObject requestData = new JSONObject();\n        JSONObject requestDataEncrypted = new JSONObject();\n        try {\n            //input your API parameters\n            requestData.put(\"password\", oldPassword);\n            requestData.put(\"new_password\", newPassword);\n\n            // Encrypt data before sending\n            requestDataEncrypted.put(\"enc_data\", EncryptDecrypt.encrypt(requestData.toString()));\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        // Enter the correct url for your api service site\n        final JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(Request.Method.POST, finalurl, requestDataEncrypted,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n\n                        Toast.makeText(getApplicationContext(),\"Done\", Toast.LENGTH_SHORT).show();\n                        SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                        sharedPreferences.edit().putBoolean(\"isloggedin\", false).apply();\n                        startActivity(new Intent(ResetPassword.this, BankLogin.class));\n\n\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \" + retrivedToken);\n                return headers;\n            }};\n\n        requestQueue.add(jsonObjectRequest);\n\n    }\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "onCreate",
            "return_type": "void",
            "position": {
              "start_line": 29,
              "end_line": 33,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_passreset);\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "resetPassword",
            "return_type": "void",
            "position": {
              "start_line": 35,
              "end_line": 97,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void resetPassword(View view) {\n        EditText oldPass = findViewById(R.id.oldlogin_password_editText);\n        EditText newPass = findViewById(R.id.newlogin_password_editText);\n        EditText newPassConfirm = findViewById(R.id.new1login_password_editText);\n        final String oldPassword = oldPass.getText().toString().trim();\n        final String newPassword = newPass.getText().toString().trim();\n        final String newpasswordConfirm = newPassConfirm.getText().toString().trim();\n\n        if (!newPassword.equals(newpasswordConfirm)) {\n            Toast.makeText(getApplicationContext(), \"Something Entered Password is Different\", Toast.LENGTH_SHORT).show();\n        }\n\n        else{\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url = sharedPreferences.getString(\"apiurl\", null);\n        String endpoint = \"/api/user/change-password\";\n        String finalurl = url + endpoint;\n\n        final RequestQueue requestQueue = Volley.newRequestQueue(getApplicationContext());\n        JSONObject requestData = new JSONObject();\n        JSONObject requestDataEncrypted = new JSONObject();\n        try {\n            //input your API parameters\n            requestData.put(\"password\", oldPassword);\n            requestData.put(\"new_password\", newPassword);\n\n            // Encrypt data before sending\n            requestDataEncrypted.put(\"enc_data\", EncryptDecrypt.encrypt(requestData.toString()));\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        // Enter the correct url for your api service site\n        final JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(Request.Method.POST, finalurl, requestDataEncrypted,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n\n                        Toast.makeText(getApplicationContext(),\"Done\", Toast.LENGTH_SHORT).show();\n                        SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                        sharedPreferences.edit().putBoolean(\"isloggedin\", false).apply();\n                        startActivity(new Intent(ResetPassword.this, BankLogin.class));\n\n\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \" + retrivedToken);\n                return headers;\n            }};\n\n        requestQueue.add(jsonObjectRequest);\n\n    }\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onResponse",
            "return_type": "void",
            "position": {
              "start_line": 69,
              "end_line": 78,
              "start_column": 20,
              "end_column": 21
            },
            "code": "@Override\n                    public void onResponse(JSONObject response) {\n\n                        Toast.makeText(getApplicationContext(),\"Done\", Toast.LENGTH_SHORT).show();\n                        SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                        sharedPreferences.edit().putBoolean(\"isloggedin\", false).apply();\n                        startActivity(new Intent(ResetPassword.this, BankLogin.class));\n\n\n                    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onErrorResponse",
            "return_type": "void",
            "position": {
              "start_line": 80,
              "end_line": 83,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getHeaders",
            "return_type": "Map",
            "position": {
              "start_line": 85,
              "end_line": 92,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \" + retrivedToken);\n                return headers;\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/MainActivity.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport androidx.appcompat.app.AlertDialog;\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport android.content.Context;\nimport android.content.DialogInterface;\nimport android.content.Intent;\nimport android.content.SharedPreferences;\nimport android.content.pm.ApplicationInfo;\nimport android.graphics.Color;\nimport android.os.Bundle;\nimport android.util.Log;\nimport android.view.View;\nimport android.view.WindowManager;\nimport android.widget.Button;\nimport android.widget.EditText;\nimport android.widget.Toast;\n\nimport com.android.volley.Request;\nimport com.android.volley.RequestQueue;\nimport com.android.volley.Response;\nimport com.android.volley.VolleyError;\nimport com.android.volley.toolbox.StringRequest;\nimport com.android.volley.toolbox.Volley;\n\nimport org.json.JSONException;\nimport org.json.JSONObject;\n\npublic class MainActivity extends AppCompatActivity {\n\n    @Override\n    public void onBackPressed() {\n        new AlertDialog.Builder(this)\n                .setTitle(\"Really Exit?\")\n                .setMessage(\"Are you sure you want to exit?\")\n                .setNegativeButton(android.R.string.no, null)\n                .setPositiveButton(android.R.string.yes, new DialogInterface.OnClickListener() {\n\n                    public void onClick(DialogInterface arg0, int arg1) {\n                        MainActivity.super.onBackPressed();\n                        System.exit(0);\n                    }\n                }).create().show();\n    }\n\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,WindowManager.LayoutParams.FLAG_FULLSCREEN);\n        setContentView(R.layout.activity_banklogin);\n\n       boolean isDebuggable = (0 != (getApplicationInfo().flags & ApplicationInfo.FLAG_DEBUGGABLE));\n       FridaCheckJNI fridaCheck = new FridaCheckJNI();\n\n\n       if(android.os.Debug.isDebuggerConnected()){\n            Toast.makeText(getApplicationContext(), \"Debug from vm\",Toast.LENGTH_LONG).show();\n        }\n\n        if(EmulatorDetectortest.isEmulator()){\n            Toast.makeText(getApplicationContext(), \"Emulator Detected\",Toast.LENGTH_LONG).show();\n        }\n\n        if(isDebuggable){\n            Toast.makeText(getApplicationContext(),\"Debbuger is Running\", Toast.LENGTH_SHORT).show();\n        }\n\n        if(RootUtil.isDeviceRooted()) {\n            Toast.makeText(getApplicationContext(), \"Phone is Rooted\", Toast.LENGTH_SHORT).show();\n            finish();\n        }\n\n        // Check frida\n\n        if(fridaCheck.fridaCheck() == 1) {\n            Toast.makeText(getApplicationContext(), \"Frida is running\", Toast.LENGTH_SHORT).show();\n            Log.d(\"FRIDA CHECK\", \"FRIDA Server DETECTED\");\n\n            finish();\n        } else {\n            Log.d(\"FRIDA CHECK\", \"FRIDA Server NOT RUNNING\");\n            Toast.makeText(getApplicationContext(), \"Frida is NOT running\", Toast.LENGTH_SHORT).show();\n        }\n\n\n\n\n\n        SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n        boolean isloggedin=sharedPreferences.getBoolean(\"isloggedin\", false);\n        if(isloggedin)\n        {\n            startActivity(new Intent(getApplicationContext(), Dashboard.class));\n            finish();\n        }\n\n    }\n\n\n\n    public void loginPage(View view){\n        Intent intent =new Intent(getApplicationContext(), BankLogin.class);\n        startActivity(intent);\n    }\n\n    public void signupPage(View view){\n        Intent intent =new Intent(getApplicationContext(), RegisterBank.class);\n        startActivity(intent);\n    }\n\n    public void healthCheck(View v){\n        SharedPreferences pref = getApplicationContext().getSharedPreferences(\"apiurl\", MODE_PRIVATE);\n        SharedPreferences.Editor editor = pref.edit();\n        EditText ed=findViewById(R.id.apiurl);\n        final String api =ed.getText().toString().trim();\n        editor.putString(\"apiurl\", api);\n        editor.apply();\n        final View vButton = findViewById(R.id.healthc);\n        final Button bButton = (Button) findViewById(R.id.healthc);\n        RequestQueue queue = Volley.newRequestQueue(this);\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint=\"/api/health/check\";\n        String finalurl = url+endpoint;\n\n        try {\n            // {\"enc_data\": \"<b64>\"}\n            JSONObject encData = new JSONObject();\n            encData.put(\"enc_data\", \"GmdBWksdEwAZFAlLVEdDX1FKS0JtQU1DHggaBkNXQQFjTkdBTUMJBgMCFQUIFA5MXUFPDxUdBg4PCkNWY05HQU1DFAYaDwgDBlhTTkUSAgwfHQcJBk9rWkkTbRw=\");\n//            String jsonObject = encData.get(\"enc_data\").toString();\n//            String object = jsonObject.toString();\n//            Log.d(\"DECRYPTING: \", jsonObject);\n            String decryptedString = EncryptDecrypt.decrypt(encData.get(\"enc_data\").toString());\n            JSONObject decryptedResponse = new JSONObject(decryptedString);\n//            String decryptedString = EncryptData.decrypt(\"GmdBWksdEwAZFAlLVEdDX1FKS0JtQU1DHggaBkNXQQFjTkdBTUMJBgMCFQUIFA5MXUFPDxUdBg4PCkNWY05HQU1DFAYaDwgDBlhTTkUSAgwfHQcJBk9rWkkTbRw=\");\n//            JSONObject decryptedResponse = new JSONObject(decryptedString);\n\n            Log.d(\"DECRYPTING: \", decryptedResponse.toString());\n\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        StringRequest stringRequest = new StringRequest(Request.Method.GET, finalurl,\n                new Response.Listener<String>() {\n                    @Override\n                    public void onResponse(String response) {\n                        bButton.setText(\"Api is Up\");\n                        bButton.setTextColor(Color.GREEN);\n\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                bButton.setText(\"Api is Down\");\n                bButton.setTextColor(Color.RED);\n            }\n        });\n        queue.add(stringRequest);\n        queue.getCache().clear();\n    }\n}",
    "classes": [
      {
        "parent_file": null,
        "name": "MainActivity",
        "position": {
          "start_line": 30,
          "end_line": 163,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class MainActivity extends AppCompatActivity {\n\n    @Override\n    public void onBackPressed() {\n        new AlertDialog.Builder(this)\n                .setTitle(\"Really Exit?\")\n                .setMessage(\"Are you sure you want to exit?\")\n                .setNegativeButton(android.R.string.no, null)\n                .setPositiveButton(android.R.string.yes, new DialogInterface.OnClickListener() {\n\n                    public void onClick(DialogInterface arg0, int arg1) {\n                        MainActivity.super.onBackPressed();\n                        System.exit(0);\n                    }\n                }).create().show();\n    }\n\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,WindowManager.LayoutParams.FLAG_FULLSCREEN);\n        setContentView(R.layout.activity_banklogin);\n\n       boolean isDebuggable = (0 != (getApplicationInfo().flags & ApplicationInfo.FLAG_DEBUGGABLE));\n       FridaCheckJNI fridaCheck = new FridaCheckJNI();\n\n\n       if(android.os.Debug.isDebuggerConnected()){\n            Toast.makeText(getApplicationContext(), \"Debug from vm\",Toast.LENGTH_LONG).show();\n        }\n\n        if(EmulatorDetectortest.isEmulator()){\n            Toast.makeText(getApplicationContext(), \"Emulator Detected\",Toast.LENGTH_LONG).show();\n        }\n\n        if(isDebuggable){\n            Toast.makeText(getApplicationContext(),\"Debbuger is Running\", Toast.LENGTH_SHORT).show();\n        }\n\n        if(RootUtil.isDeviceRooted()) {\n            Toast.makeText(getApplicationContext(), \"Phone is Rooted\", Toast.LENGTH_SHORT).show();\n            finish();\n        }\n\n        // Check frida\n\n        if(fridaCheck.fridaCheck() == 1) {\n            Toast.makeText(getApplicationContext(), \"Frida is running\", Toast.LENGTH_SHORT).show();\n            Log.d(\"FRIDA CHECK\", \"FRIDA Server DETECTED\");\n\n            finish();\n        } else {\n            Log.d(\"FRIDA CHECK\", \"FRIDA Server NOT RUNNING\");\n            Toast.makeText(getApplicationContext(), \"Frida is NOT running\", Toast.LENGTH_SHORT).show();\n        }\n\n\n\n\n\n        SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n        boolean isloggedin=sharedPreferences.getBoolean(\"isloggedin\", false);\n        if(isloggedin)\n        {\n            startActivity(new Intent(getApplicationContext(), Dashboard.class));\n            finish();\n        }\n\n    }\n\n\n\n    public void loginPage(View view){\n        Intent intent =new Intent(getApplicationContext(), BankLogin.class);\n        startActivity(intent);\n    }\n\n    public void signupPage(View view){\n        Intent intent =new Intent(getApplicationContext(), RegisterBank.class);\n        startActivity(intent);\n    }\n\n    public void healthCheck(View v){\n        SharedPreferences pref = getApplicationContext().getSharedPreferences(\"apiurl\", MODE_PRIVATE);\n        SharedPreferences.Editor editor = pref.edit();\n        EditText ed=findViewById(R.id.apiurl);\n        final String api =ed.getText().toString().trim();\n        editor.putString(\"apiurl\", api);\n        editor.apply();\n        final View vButton = findViewById(R.id.healthc);\n        final Button bButton = (Button) findViewById(R.id.healthc);\n        RequestQueue queue = Volley.newRequestQueue(this);\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint=\"/api/health/check\";\n        String finalurl = url+endpoint;\n\n        try {\n            // {\"enc_data\": \"<b64>\"}\n            JSONObject encData = new JSONObject();\n            encData.put(\"enc_data\", \"GmdBWksdEwAZFAlLVEdDX1FKS0JtQU1DHggaBkNXQQFjTkdBTUMJBgMCFQUIFA5MXUFPDxUdBg4PCkNWY05HQU1DFAYaDwgDBlhTTkUSAgwfHQcJBk9rWkkTbRw=\");\n//            String jsonObject = encData.get(\"enc_data\").toString();\n//            String object = jsonObject.toString();\n//            Log.d(\"DECRYPTING: \", jsonObject);\n            String decryptedString = EncryptDecrypt.decrypt(encData.get(\"enc_data\").toString());\n            JSONObject decryptedResponse = new JSONObject(decryptedString);\n//            String decryptedString = EncryptData.decrypt(\"GmdBWksdEwAZFAlLVEdDX1FKS0JtQU1DHggaBkNXQQFjTkdBTUMJBgMCFQUIFA5MXUFPDxUdBg4PCkNWY05HQU1DFAYaDwgDBlhTTkUSAgwfHQcJBk9rWkkTbRw=\");\n//            JSONObject decryptedResponse = new JSONObject(decryptedString);\n\n            Log.d(\"DECRYPTING: \", decryptedResponse.toString());\n\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        StringRequest stringRequest = new StringRequest(Request.Method.GET, finalurl,\n                new Response.Listener<String>() {\n                    @Override\n                    public void onResponse(String response) {\n                        bButton.setText(\"Api is Up\");\n                        bButton.setTextColor(Color.GREEN);\n\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                bButton.setText(\"Api is Down\");\n                bButton.setTextColor(Color.RED);\n            }\n        });\n        queue.add(stringRequest);\n        queue.getCache().clear();\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "onBackPressed",
            "return_type": "void",
            "position": {
              "start_line": 32,
              "end_line": 45,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    public void onBackPressed() {\n        new AlertDialog.Builder(this)\n                .setTitle(\"Really Exit?\")\n                .setMessage(\"Are you sure you want to exit?\")\n                .setNegativeButton(android.R.string.no, null)\n                .setPositiveButton(android.R.string.yes, new DialogInterface.OnClickListener() {\n\n                    public void onClick(DialogInterface arg0, int arg1) {\n                        MainActivity.super.onBackPressed();\n                        System.exit(0);\n                    }\n                }).create().show();\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onClick",
            "return_type": "void",
            "position": {
              "start_line": 40,
              "end_line": 43,
              "start_column": 20,
              "end_column": 21
            },
            "code": "public void onClick(DialogInterface arg0, int arg1) {\n                        MainActivity.super.onBackPressed();\n                        System.exit(0);\n                    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onCreate",
            "return_type": "void",
            "position": {
              "start_line": 48,
              "end_line": 99,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,WindowManager.LayoutParams.FLAG_FULLSCREEN);\n        setContentView(R.layout.activity_banklogin);\n\n       boolean isDebuggable = (0 != (getApplicationInfo().flags & ApplicationInfo.FLAG_DEBUGGABLE));\n       FridaCheckJNI fridaCheck = new FridaCheckJNI();\n\n\n       if(android.os.Debug.isDebuggerConnected()){\n            Toast.makeText(getApplicationContext(), \"Debug from vm\",Toast.LENGTH_LONG).show();\n        }\n\n        if(EmulatorDetectortest.isEmulator()){\n            Toast.makeText(getApplicationContext(), \"Emulator Detected\",Toast.LENGTH_LONG).show();\n        }\n\n        if(isDebuggable){\n            Toast.makeText(getApplicationContext(),\"Debbuger is Running\", Toast.LENGTH_SHORT).show();\n        }\n\n        if(RootUtil.isDeviceRooted()) {\n            Toast.makeText(getApplicationContext(), \"Phone is Rooted\", Toast.LENGTH_SHORT).show();\n            finish();\n        }\n\n        // Check frida\n\n        if(fridaCheck.fridaCheck() == 1) {\n            Toast.makeText(getApplicationContext(), \"Frida is running\", Toast.LENGTH_SHORT).show();\n            Log.d(\"FRIDA CHECK\", \"FRIDA Server DETECTED\");\n\n            finish();\n        } else {\n            Log.d(\"FRIDA CHECK\", \"FRIDA Server NOT RUNNING\");\n            Toast.makeText(getApplicationContext(), \"Frida is NOT running\", Toast.LENGTH_SHORT).show();\n        }\n\n\n\n\n\n        SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n        boolean isloggedin=sharedPreferences.getBoolean(\"isloggedin\", false);\n        if(isloggedin)\n        {\n            startActivity(new Intent(getApplicationContext(), Dashboard.class));\n            finish();\n        }\n\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "loginPage",
            "return_type": "void",
            "position": {
              "start_line": 103,
              "end_line": 106,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void loginPage(View view){\n        Intent intent =new Intent(getApplicationContext(), BankLogin.class);\n        startActivity(intent);\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "signupPage",
            "return_type": "void",
            "position": {
              "start_line": 108,
              "end_line": 111,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void signupPage(View view){\n        Intent intent =new Intent(getApplicationContext(), RegisterBank.class);\n        startActivity(intent);\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "healthCheck",
            "return_type": "void",
            "position": {
              "start_line": 113,
              "end_line": 162,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void healthCheck(View v){\n        SharedPreferences pref = getApplicationContext().getSharedPreferences(\"apiurl\", MODE_PRIVATE);\n        SharedPreferences.Editor editor = pref.edit();\n        EditText ed=findViewById(R.id.apiurl);\n        final String api =ed.getText().toString().trim();\n        editor.putString(\"apiurl\", api);\n        editor.apply();\n        final View vButton = findViewById(R.id.healthc);\n        final Button bButton = (Button) findViewById(R.id.healthc);\n        RequestQueue queue = Volley.newRequestQueue(this);\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint=\"/api/health/check\";\n        String finalurl = url+endpoint;\n\n        try {\n            // {\"enc_data\": \"<b64>\"}\n            JSONObject encData = new JSONObject();\n            encData.put(\"enc_data\", \"GmdBWksdEwAZFAlLVEdDX1FKS0JtQU1DHggaBkNXQQFjTkdBTUMJBgMCFQUIFA5MXUFPDxUdBg4PCkNWY05HQU1DFAYaDwgDBlhTTkUSAgwfHQcJBk9rWkkTbRw=\");\n//            String jsonObject = encData.get(\"enc_data\").toString();\n//            String object = jsonObject.toString();\n//            Log.d(\"DECRYPTING: \", jsonObject);\n            String decryptedString = EncryptDecrypt.decrypt(encData.get(\"enc_data\").toString());\n            JSONObject decryptedResponse = new JSONObject(decryptedString);\n//            String decryptedString = EncryptData.decrypt(\"GmdBWksdEwAZFAlLVEdDX1FKS0JtQU1DHggaBkNXQQFjTkdBTUMJBgMCFQUIFA5MXUFPDxUdBg4PCkNWY05HQU1DFAYaDwgDBlhTTkUSAgwfHQcJBk9rWkkTbRw=\");\n//            JSONObject decryptedResponse = new JSONObject(decryptedString);\n\n            Log.d(\"DECRYPTING: \", decryptedResponse.toString());\n\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        StringRequest stringRequest = new StringRequest(Request.Method.GET, finalurl,\n                new Response.Listener<String>() {\n                    @Override\n                    public void onResponse(String response) {\n                        bButton.setText(\"Api is Up\");\n                        bButton.setTextColor(Color.GREEN);\n\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                bButton.setText(\"Api is Down\");\n                bButton.setTextColor(Color.RED);\n            }\n        });\n        queue.add(stringRequest);\n        queue.getCache().clear();\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onResponse",
            "return_type": "void",
            "position": {
              "start_line": 147,
              "end_line": 152,
              "start_column": 20,
              "end_column": 21
            },
            "code": "@Override\n                    public void onResponse(String response) {\n                        bButton.setText(\"Api is Up\");\n                        bButton.setTextColor(Color.GREEN);\n\n                    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onErrorResponse",
            "return_type": "void",
            "position": {
              "start_line": 154,
              "end_line": 158,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public void onErrorResponse(VolleyError error) {\n                bButton.setText(\"Api is Down\");\n                bButton.setTextColor(Color.RED);\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/GetTransactions.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport androidx.appcompat.app.AppCompatActivity;\nimport androidx.recyclerview.widget.LinearLayoutManager;\nimport androidx.recyclerview.widget.RecyclerView;\n\nimport android.content.Context;\nimport android.content.SharedPreferences;\nimport android.os.Bundle;\nimport android.view.View;\nimport android.widget.TextView;\nimport android.widget.Toast;\n\nimport com.android.volley.AuthFailureError;\nimport com.android.volley.Request;\nimport com.android.volley.RequestQueue;\nimport com.android.volley.Response;\nimport com.android.volley.VolleyError;\nimport com.android.volley.toolbox.JsonObjectRequest;\nimport com.android.volley.toolbox.Volley;\n\nimport org.json.JSONArray;\nimport org.json.JSONException;\nimport org.json.JSONObject;\n\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\npublic class GetTransactions extends AppCompatActivity {\n\n        RecyclerView recyclerView;\n        List<TransactionRecords> trecords;\n        private TextView emptyView;\n\n\n    Adapter adapter;\n\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_transactions);\n\n        recyclerView=findViewById(R.id.transt);\n        trecords=new ArrayList<>();\n        emptyView = findViewById(R.id.empty_view);\n        extractRecords();\n\n    }\n\n    private void extractRecords() {\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint=\"/api/transactions/view\";\n        final String finalurl = url + endpoint;\n        RequestQueue queue = Volley.newRequestQueue(this);\n        JsonObjectRequest jsonArrayRequest = new JsonObjectRequest(Request.Method.POST, finalurl, null,\n                new Response.Listener<JSONObject>() {\n            @Override\n            public void onResponse(JSONObject response) {\n\n                    try {\n\n                        JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                        // Check for error message\n                        if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                            Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                            return;\n                            // This is buggy. Need to call Login activity again if incorrect credentials are given\n                        }\n\n                        JSONArray jsonArray = decryptedResponse.getJSONArray(\"data\");\n                        for(int i = 0; i < jsonArray.length(); i++) {\n\n\n                            JSONObject transrecobject = jsonArray.getJSONObject(i);\n                            TransactionRecords trecorder = new TransactionRecords();\n                            trecorder.setFromaccnt(transrecobject.getString(\"from_account\").toString());\n                            trecorder.setToaccnt(transrecobject.getString(\"to_account\").toString());\n                            trecorder.setAmount(transrecobject.getString(\"amount\").toString());\n                            trecords.add(trecorder);\n                        }\n\n                    } catch (JSONException e) {\n                        e.printStackTrace();\n                    }\n\n                recyclerView.setLayoutManager(new LinearLayoutManager(getApplicationContext()));\n                adapter=new Adapter(getApplicationContext(),trecords);\n                recyclerView.setAdapter(adapter);\n                Integer count=adapter.getItemCount();\n                if (count == 0) {\n                    recyclerView.setVisibility(View.GONE);\n                    emptyView.setVisibility(View.VISIBLE);\n                }\n                else {\n                    recyclerView.setVisibility(View.VISIBLE);\n                    emptyView.setVisibility(View.GONE);\n                }\n                }\n\n        }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n                @Override\n                public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n        }};\n\n        queue.add(jsonArrayRequest);\n        queue.getCache().clear();\n    }\n}",
    "classes": [
      {
        "parent_file": null,
        "name": "GetTransactions",
        "position": {
          "start_line": 31,
          "end_line": 123,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class GetTransactions extends AppCompatActivity {\n\n        RecyclerView recyclerView;\n        List<TransactionRecords> trecords;\n        private TextView emptyView;\n\n\n    Adapter adapter;\n\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_transactions);\n\n        recyclerView=findViewById(R.id.transt);\n        trecords=new ArrayList<>();\n        emptyView = findViewById(R.id.empty_view);\n        extractRecords();\n\n    }\n\n    private void extractRecords() {\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint=\"/api/transactions/view\";\n        final String finalurl = url + endpoint;\n        RequestQueue queue = Volley.newRequestQueue(this);\n        JsonObjectRequest jsonArrayRequest = new JsonObjectRequest(Request.Method.POST, finalurl, null,\n                new Response.Listener<JSONObject>() {\n            @Override\n            public void onResponse(JSONObject response) {\n\n                    try {\n\n                        JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                        // Check for error message\n                        if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                            Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                            return;\n                            // This is buggy. Need to call Login activity again if incorrect credentials are given\n                        }\n\n                        JSONArray jsonArray = decryptedResponse.getJSONArray(\"data\");\n                        for(int i = 0; i < jsonArray.length(); i++) {\n\n\n                            JSONObject transrecobject = jsonArray.getJSONObject(i);\n                            TransactionRecords trecorder = new TransactionRecords();\n                            trecorder.setFromaccnt(transrecobject.getString(\"from_account\").toString());\n                            trecorder.setToaccnt(transrecobject.getString(\"to_account\").toString());\n                            trecorder.setAmount(transrecobject.getString(\"amount\").toString());\n                            trecords.add(trecorder);\n                        }\n\n                    } catch (JSONException e) {\n                        e.printStackTrace();\n                    }\n\n                recyclerView.setLayoutManager(new LinearLayoutManager(getApplicationContext()));\n                adapter=new Adapter(getApplicationContext(),trecords);\n                recyclerView.setAdapter(adapter);\n                Integer count=adapter.getItemCount();\n                if (count == 0) {\n                    recyclerView.setVisibility(View.GONE);\n                    emptyView.setVisibility(View.VISIBLE);\n                }\n                else {\n                    recyclerView.setVisibility(View.VISIBLE);\n                    emptyView.setVisibility(View.GONE);\n                }\n                }\n\n        }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n                @Override\n                public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n        }};\n\n        queue.add(jsonArrayRequest);\n        queue.getCache().clear();\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "onCreate",
            "return_type": "void",
            "position": {
              "start_line": 41,
              "end_line": 51,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_transactions);\n\n        recyclerView=findViewById(R.id.transt);\n        trecords=new ArrayList<>();\n        emptyView = findViewById(R.id.empty_view);\n        extractRecords();\n\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "extractRecords",
            "return_type": "void",
            "position": {
              "start_line": 53,
              "end_line": 122,
              "start_column": 4,
              "end_column": 5
            },
            "code": "private void extractRecords() {\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint=\"/api/transactions/view\";\n        final String finalurl = url + endpoint;\n        RequestQueue queue = Volley.newRequestQueue(this);\n        JsonObjectRequest jsonArrayRequest = new JsonObjectRequest(Request.Method.POST, finalurl, null,\n                new Response.Listener<JSONObject>() {\n            @Override\n            public void onResponse(JSONObject response) {\n\n                    try {\n\n                        JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                        // Check for error message\n                        if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                            Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                            return;\n                            // This is buggy. Need to call Login activity again if incorrect credentials are given\n                        }\n\n                        JSONArray jsonArray = decryptedResponse.getJSONArray(\"data\");\n                        for(int i = 0; i < jsonArray.length(); i++) {\n\n\n                            JSONObject transrecobject = jsonArray.getJSONObject(i);\n                            TransactionRecords trecorder = new TransactionRecords();\n                            trecorder.setFromaccnt(transrecobject.getString(\"from_account\").toString());\n                            trecorder.setToaccnt(transrecobject.getString(\"to_account\").toString());\n                            trecorder.setAmount(transrecobject.getString(\"amount\").toString());\n                            trecords.add(trecorder);\n                        }\n\n                    } catch (JSONException e) {\n                        e.printStackTrace();\n                    }\n\n                recyclerView.setLayoutManager(new LinearLayoutManager(getApplicationContext()));\n                adapter=new Adapter(getApplicationContext(),trecords);\n                recyclerView.setAdapter(adapter);\n                Integer count=adapter.getItemCount();\n                if (count == 0) {\n                    recyclerView.setVisibility(View.GONE);\n                    emptyView.setVisibility(View.VISIBLE);\n                }\n                else {\n                    recyclerView.setVisibility(View.VISIBLE);\n                    emptyView.setVisibility(View.GONE);\n                }\n                }\n\n        }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n                @Override\n                public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n        }};\n\n        queue.add(jsonArrayRequest);\n        queue.getCache().clear();\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onResponse",
            "return_type": "void",
            "position": {
              "start_line": 61,
              "end_line": 103,
              "start_column": 12,
              "end_column": 17
            },
            "code": "@Override\n            public void onResponse(JSONObject response) {\n\n                    try {\n\n                        JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                        // Check for error message\n                        if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                            Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                            return;\n                            // This is buggy. Need to call Login activity again if incorrect credentials are given\n                        }\n\n                        JSONArray jsonArray = decryptedResponse.getJSONArray(\"data\");\n                        for(int i = 0; i < jsonArray.length(); i++) {\n\n\n                            JSONObject transrecobject = jsonArray.getJSONObject(i);\n                            TransactionRecords trecorder = new TransactionRecords();\n                            trecorder.setFromaccnt(transrecobject.getString(\"from_account\").toString());\n                            trecorder.setToaccnt(transrecobject.getString(\"to_account\").toString());\n                            trecorder.setAmount(transrecobject.getString(\"amount\").toString());\n                            trecords.add(trecorder);\n                        }\n\n                    } catch (JSONException e) {\n                        e.printStackTrace();\n                    }\n\n                recyclerView.setLayoutManager(new LinearLayoutManager(getApplicationContext()));\n                adapter=new Adapter(getApplicationContext(),trecords);\n                recyclerView.setAdapter(adapter);\n                Integer count=adapter.getItemCount();\n                if (count == 0) {\n                    recyclerView.setVisibility(View.GONE);\n                    emptyView.setVisibility(View.VISIBLE);\n                }\n                else {\n                    recyclerView.setVisibility(View.VISIBLE);\n                    emptyView.setVisibility(View.GONE);\n                }\n                }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onErrorResponse",
            "return_type": "void",
            "position": {
              "start_line": 106,
              "end_line": 109,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getHeaders",
            "return_type": "Map",
            "position": {
              "start_line": 111,
              "end_line": 118,
              "start_column": 16,
              "end_column": 9
            },
            "code": "@Override\n                public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n        }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/BeneficiaryRecords.java",
    "code": "package com.app.damnvulnerablebank;\n\npublic class BeneficiaryRecords {\n    private String benificiaryaccnt;\n    private String isapproved;\n\n    public BeneficiaryRecords(){}\n\n    public String getBeneficiaryAccount() {\n        return benificiaryaccnt;\n    }\n\n    public void setBeneficiaryAccount(String benificiaryaccnt) {\n        this.benificiaryaccnt = \"Account Number\\n\"+benificiaryaccnt+\"\\n\\n\";\n    }\n\n    public String getIsApproved() {\n        return isapproved;\n    }\n\n    public void setIsApproved(String isapproved) {\n        this.isapproved = \"\\n\\nAccount Approved By Admin\\n\" + isapproved;\n    }\n\n    public BeneficiaryRecords(String benificiaryaccnt, String isapproved){\n\n    }\n}\n",
    "classes": [
      {
        "parent_file": null,
        "name": "BeneficiaryRecords",
        "position": {
          "start_line": 3,
          "end_line": 28,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class BeneficiaryRecords {\n    private String benificiaryaccnt;\n    private String isapproved;\n\n    public BeneficiaryRecords(){}\n\n    public String getBeneficiaryAccount() {\n        return benificiaryaccnt;\n    }\n\n    public void setBeneficiaryAccount(String benificiaryaccnt) {\n        this.benificiaryaccnt = \"Account Number\\n\"+benificiaryaccnt+\"\\n\\n\";\n    }\n\n    public String getIsApproved() {\n        return isapproved;\n    }\n\n    public void setIsApproved(String isapproved) {\n        this.isapproved = \"\\n\\nAccount Approved By Admin\\n\" + isapproved;\n    }\n\n    public BeneficiaryRecords(String benificiaryaccnt, String isapproved){\n\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "getBeneficiaryAccount",
            "return_type": "String",
            "position": {
              "start_line": 9,
              "end_line": 11,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public String getBeneficiaryAccount() {\n        return benificiaryaccnt;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "setBeneficiaryAccount",
            "return_type": "void",
            "position": {
              "start_line": 13,
              "end_line": 15,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void setBeneficiaryAccount(String benificiaryaccnt) {\n        this.benificiaryaccnt = \"Account Number\\n\"+benificiaryaccnt+\"\\n\\n\";\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getIsApproved",
            "return_type": "String",
            "position": {
              "start_line": 17,
              "end_line": 19,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public String getIsApproved() {\n        return isapproved;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "setIsApproved",
            "return_type": "void",
            "position": {
              "start_line": 21,
              "end_line": 23,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void setIsApproved(String isapproved) {\n        this.isapproved = \"\\n\\nAccount Approved By Admin\\n\" + isapproved;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/EncryptDecrypt.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport android.util.Base64;\n\npublic class EncryptDecrypt {\n    static public String secret = \"amazing\";\n    static public int secretLength = secret.length();\n\n    public static String operate(String input) {\n        String result = \"\";\n        for(int i = 0; i < input.length(); i++) {\n            int xorVal = (int) input.charAt(i) ^ (int) secret.charAt(i % secretLength);\n            char xorChar =  (char) xorVal;\n\n            result += xorChar;\n        }\n\n        return result;\n    }\n\n    public static String encrypt(String input) {\n        String encVal = operate(input);\n        String val = Base64.encodeToString(encVal.getBytes(),0);\n\n        return val;\n    }\n\n    public static String decrypt(String input) {\n        byte[] decodeByte = Base64.decode(input,0);\n        String decodeString = new String(decodeByte);\n        String decryptString = operate(decodeString);\n\n        return decryptString;\n    }\n}\n",
    "classes": [
      {
        "parent_file": null,
        "name": "EncryptDecrypt",
        "position": {
          "start_line": 5,
          "end_line": 35,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class EncryptDecrypt {\n    static public String secret = \"amazing\";\n    static public int secretLength = secret.length();\n\n    public static String operate(String input) {\n        String result = \"\";\n        for(int i = 0; i < input.length(); i++) {\n            int xorVal = (int) input.charAt(i) ^ (int) secret.charAt(i % secretLength);\n            char xorChar =  (char) xorVal;\n\n            result += xorChar;\n        }\n\n        return result;\n    }\n\n    public static String encrypt(String input) {\n        String encVal = operate(input);\n        String val = Base64.encodeToString(encVal.getBytes(),0);\n\n        return val;\n    }\n\n    public static String decrypt(String input) {\n        byte[] decodeByte = Base64.decode(input,0);\n        String decodeString = new String(decodeByte);\n        String decryptString = operate(decodeString);\n\n        return decryptString;\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "operate",
            "return_type": "String",
            "position": {
              "start_line": 9,
              "end_line": 19,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public static String operate(String input) {\n        String result = \"\";\n        for(int i = 0; i < input.length(); i++) {\n            int xorVal = (int) input.charAt(i) ^ (int) secret.charAt(i % secretLength);\n            char xorChar =  (char) xorVal;\n\n            result += xorChar;\n        }\n\n        return result;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "encrypt",
            "return_type": "String",
            "position": {
              "start_line": 21,
              "end_line": 26,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public static String encrypt(String input) {\n        String encVal = operate(input);\n        String val = Base64.encodeToString(encVal.getBytes(),0);\n\n        return val;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "decrypt",
            "return_type": "String",
            "position": {
              "start_line": 28,
              "end_line": 34,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public static String decrypt(String input) {\n        byte[] decodeByte = Base64.decode(input,0);\n        String decodeString = new String(decodeByte);\n        String decryptString = operate(decodeString);\n\n        return decryptString;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/Dashboard.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport androidx.appcompat.app.AlertDialog;\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport android.content.DialogInterface;\nimport android.content.Intent;\nimport android.content.SharedPreferences;\nimport android.os.Bundle;\nimport android.view.View;\nimport android.widget.TextView;\nimport android.widget.Toast;\n\npublic class Dashboard extends AppCompatActivity {\n\n    @Override\n    public void onBackPressed() {\n        new AlertDialog.Builder(this)\n                .setTitle(\"Really Exit?\")\n                .setMessage(\"Are you sure you want to exit?\")\n                .setNegativeButton(android.R.string.no, null)\n                .setPositiveButton(android.R.string.yes, new DialogInterface.OnClickListener() {\n\n                    public void onClick(DialogInterface arg0, int arg1) {\n                        Dashboard.super.onBackPressed();\n                        System.exit(0);\n                    }\n                }).create().show();\n    }\n\n\n    public void logout(View view){\n        SharedPreferences pref = getApplicationContext().getSharedPreferences(\"jwt\", MODE_PRIVATE);\n        SharedPreferences.Editor editor = pref.edit();\n        editor.putBoolean(\"isloggedin\", false);\n        editor.apply();\n        startActivity(new Intent(getApplicationContext(), MainActivity.class));\n    }\n    public void addBeneficiary(View v){\n        startActivity(new Intent(getApplicationContext(), AddBeneficiary.class));\n    }\n    public void myprofile(View V){\n        startActivity(new Intent(getApplicationContext(), Myprofile.class));\n    }\n    public void viewbalance(View V){\n        startActivity(new Intent(getApplicationContext(), ViewBalance.class));\n    }\n    public void viewTransactions(View V){\n        startActivity(new Intent(getApplicationContext(), GetTransactions.class));\n    }\n    public void viewBeneficiaryAdmin(View V){\n        startActivity(new Intent(getApplicationContext(), ViewBeneficiaryAdmin.class));\n    }\n    public void getPendingBeneficiaries(View V){\n        startActivity(new Intent(getApplicationContext(), PendingBeneficiary.class));\n    }\n    public void viewMyBeneficiaries(View V){\n        startActivity(new Intent(getApplicationContext(), ViewBeneficiary.class));\n    }\n    public void resetPassword(View v){\n        startActivity(new Intent(getApplicationContext(), ResetPassword.class));\n    }\n    public void getCurrencyRates(View v){\n        startActivity(new Intent(getApplicationContext(), CurrencyRates.class));\n    }\n\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_dashboard);\n        TextView t1=findViewById(R.id.dasht);\n        if(RootUtil.isDeviceRooted()) {\n            Toast.makeText(getApplicationContext(), \"Phone is Rooted\", Toast.LENGTH_SHORT).show();\n            finish();\n        }\n\n\n    }\n\n\n}",
    "classes": [
      {
        "parent_file": null,
        "name": "Dashboard",
        "position": {
          "start_line": 14,
          "end_line": 82,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class Dashboard extends AppCompatActivity {\n\n    @Override\n    public void onBackPressed() {\n        new AlertDialog.Builder(this)\n                .setTitle(\"Really Exit?\")\n                .setMessage(\"Are you sure you want to exit?\")\n                .setNegativeButton(android.R.string.no, null)\n                .setPositiveButton(android.R.string.yes, new DialogInterface.OnClickListener() {\n\n                    public void onClick(DialogInterface arg0, int arg1) {\n                        Dashboard.super.onBackPressed();\n                        System.exit(0);\n                    }\n                }).create().show();\n    }\n\n\n    public void logout(View view){\n        SharedPreferences pref = getApplicationContext().getSharedPreferences(\"jwt\", MODE_PRIVATE);\n        SharedPreferences.Editor editor = pref.edit();\n        editor.putBoolean(\"isloggedin\", false);\n        editor.apply();\n        startActivity(new Intent(getApplicationContext(), MainActivity.class));\n    }\n    public void addBeneficiary(View v){\n        startActivity(new Intent(getApplicationContext(), AddBeneficiary.class));\n    }\n    public void myprofile(View V){\n        startActivity(new Intent(getApplicationContext(), Myprofile.class));\n    }\n    public void viewbalance(View V){\n        startActivity(new Intent(getApplicationContext(), ViewBalance.class));\n    }\n    public void viewTransactions(View V){\n        startActivity(new Intent(getApplicationContext(), GetTransactions.class));\n    }\n    public void viewBeneficiaryAdmin(View V){\n        startActivity(new Intent(getApplicationContext(), ViewBeneficiaryAdmin.class));\n    }\n    public void getPendingBeneficiaries(View V){\n        startActivity(new Intent(getApplicationContext(), PendingBeneficiary.class));\n    }\n    public void viewMyBeneficiaries(View V){\n        startActivity(new Intent(getApplicationContext(), ViewBeneficiary.class));\n    }\n    public void resetPassword(View v){\n        startActivity(new Intent(getApplicationContext(), ResetPassword.class));\n    }\n    public void getCurrencyRates(View v){\n        startActivity(new Intent(getApplicationContext(), CurrencyRates.class));\n    }\n\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_dashboard);\n        TextView t1=findViewById(R.id.dasht);\n        if(RootUtil.isDeviceRooted()) {\n            Toast.makeText(getApplicationContext(), \"Phone is Rooted\", Toast.LENGTH_SHORT).show();\n            finish();\n        }\n\n\n    }\n\n\n}",
        "summary": "",
        "methods": [
          {
            "name": "onBackPressed",
            "return_type": "void",
            "position": {
              "start_line": 16,
              "end_line": 29,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    public void onBackPressed() {\n        new AlertDialog.Builder(this)\n                .setTitle(\"Really Exit?\")\n                .setMessage(\"Are you sure you want to exit?\")\n                .setNegativeButton(android.R.string.no, null)\n                .setPositiveButton(android.R.string.yes, new DialogInterface.OnClickListener() {\n\n                    public void onClick(DialogInterface arg0, int arg1) {\n                        Dashboard.super.onBackPressed();\n                        System.exit(0);\n                    }\n                }).create().show();\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onClick",
            "return_type": "void",
            "position": {
              "start_line": 24,
              "end_line": 27,
              "start_column": 20,
              "end_column": 21
            },
            "code": "public void onClick(DialogInterface arg0, int arg1) {\n                        Dashboard.super.onBackPressed();\n                        System.exit(0);\n                    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "logout",
            "return_type": "void",
            "position": {
              "start_line": 32,
              "end_line": 38,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void logout(View view){\n        SharedPreferences pref = getApplicationContext().getSharedPreferences(\"jwt\", MODE_PRIVATE);\n        SharedPreferences.Editor editor = pref.edit();\n        editor.putBoolean(\"isloggedin\", false);\n        editor.apply();\n        startActivity(new Intent(getApplicationContext(), MainActivity.class));\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "addBeneficiary",
            "return_type": "void",
            "position": {
              "start_line": 39,
              "end_line": 41,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void addBeneficiary(View v){\n        startActivity(new Intent(getApplicationContext(), AddBeneficiary.class));\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "myprofile",
            "return_type": "void",
            "position": {
              "start_line": 42,
              "end_line": 44,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void myprofile(View V){\n        startActivity(new Intent(getApplicationContext(), Myprofile.class));\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "viewbalance",
            "return_type": "void",
            "position": {
              "start_line": 45,
              "end_line": 47,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void viewbalance(View V){\n        startActivity(new Intent(getApplicationContext(), ViewBalance.class));\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "viewTransactions",
            "return_type": "void",
            "position": {
              "start_line": 48,
              "end_line": 50,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void viewTransactions(View V){\n        startActivity(new Intent(getApplicationContext(), GetTransactions.class));\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "viewBeneficiaryAdmin",
            "return_type": "void",
            "position": {
              "start_line": 51,
              "end_line": 53,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void viewBeneficiaryAdmin(View V){\n        startActivity(new Intent(getApplicationContext(), ViewBeneficiaryAdmin.class));\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getPendingBeneficiaries",
            "return_type": "void",
            "position": {
              "start_line": 54,
              "end_line": 56,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void getPendingBeneficiaries(View V){\n        startActivity(new Intent(getApplicationContext(), PendingBeneficiary.class));\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "viewMyBeneficiaries",
            "return_type": "void",
            "position": {
              "start_line": 57,
              "end_line": 59,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void viewMyBeneficiaries(View V){\n        startActivity(new Intent(getApplicationContext(), ViewBeneficiary.class));\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "resetPassword",
            "return_type": "void",
            "position": {
              "start_line": 60,
              "end_line": 62,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void resetPassword(View v){\n        startActivity(new Intent(getApplicationContext(), ResetPassword.class));\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getCurrencyRates",
            "return_type": "void",
            "position": {
              "start_line": 63,
              "end_line": 65,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void getCurrencyRates(View v){\n        startActivity(new Intent(getApplicationContext(), CurrencyRates.class));\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onCreate",
            "return_type": "void",
            "position": {
              "start_line": 68,
              "end_line": 79,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_dashboard);\n        TextView t1=findViewById(R.id.dasht);\n        if(RootUtil.isDeviceRooted()) {\n            Toast.makeText(getApplicationContext(), \"Phone is Rooted\", Toast.LENGTH_SHORT).show();\n            finish();\n        }\n\n\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/PendingBeneficiary.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport androidx.appcompat.app.AppCompatActivity;\nimport androidx.recyclerview.widget.LinearLayoutManager;\nimport androidx.recyclerview.widget.RecyclerView;\n\nimport android.content.Context;\nimport android.content.Intent;\nimport android.content.SharedPreferences;\nimport android.os.Bundle;\n\nimport android.util.Log;\nimport android.view.View;\nimport android.widget.TextView;\nimport android.widget.Toast;\n\nimport com.android.volley.AuthFailureError;\nimport com.android.volley.Request;\nimport com.android.volley.RequestQueue;\nimport com.android.volley.Response;\nimport com.android.volley.VolleyError;\nimport com.android.volley.toolbox.JsonObjectRequest;\nimport com.android.volley.toolbox.Volley;\n\nimport org.json.JSONArray;\nimport org.json.JSONException;\nimport org.json.JSONObject;\n\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\npublic class PendingBeneficiary extends AppCompatActivity implements Padapter.OnItemClickListener{\n    public static final String id=\"id\";\n    RecyclerView recyclerView;\n    List<PendingBeneficiaryRecords> precords;\n    private TextView emptyView;\n    Padapter padapter;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_pendingbenificiary);\n        recyclerView=findViewById(R.id.pendb);\n        precords=new ArrayList<>();\n        emptyView = findViewById(R.id.empty_view);\n        getPendingBeneficiaries();\n    }\n\n    public void getPendingBeneficiaries(){\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint = \"/api/beneficiary/pending\";\n        String finalUrl = url + endpoint;\n        RequestQueue queue = Volley.newRequestQueue(this);\n        JsonObjectRequest jsonArrayRequest=new JsonObjectRequest(Request.Method.POST, finalUrl, null,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            Log.d(\"Pending Beneficiary\", decryptedResponse.toString());\n//                            Log.d(\"Pending Beneficiary\", decryptedResponse.getJSONObject(\"status\").getInt(\"code\"));\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONArray jsonArray = decryptedResponse .getJSONArray(\"data\");\n\n                            for(int i=0; i < jsonArray.length(); i++) {\n\n                                JSONObject transrecobject = jsonArray.getJSONObject(i);\n                                PendingBeneficiaryRecords precorder = new PendingBeneficiaryRecords();\n                                precorder.setAccountNumber(transrecobject.getString(\"account_number\").toString());\n                                precorder.setBeneficiaryAccountNumber(transrecobject.getString(\"beneficiary_account_number\").toString());\n                                precorder.setId(transrecobject.getString(\"id\").toString());\n                                precords.add(precorder);\n                            }\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n                        recyclerView.setLayoutManager(new LinearLayoutManager(getApplicationContext()));\n                        padapter = new Padapter(getApplicationContext(),precords);\n                        recyclerView.setAdapter(padapter);\n                        padapter.setOnItemClickListener(PendingBeneficiary.this);\n                        Integer count=padapter.getItemCount();\n                        if (count == 0) {\n                            recyclerView.setVisibility(View.GONE);\n                            emptyView.setVisibility(View.VISIBLE);\n                        }\n                        else {\n                            recyclerView.setVisibility(View.VISIBLE);\n                            emptyView.setVisibility(View.GONE);\n                        }\n\n                    }\n\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers = new HashMap();\n                headers.put(\"Authorization\",\"Bearer \" + retrivedToken);\n                return headers;\n            }};\n\n        queue.add(jsonArrayRequest);\n        queue.getCache().clear();\n    }\n\n    @Override\n    public void onItemClick(int position) {\n        Intent de=new Intent(this, ApproveBeneficiary.class);\n        PendingBeneficiaryRecords cf =precords.get(position);\n        de.putExtra(id,cf.getId());\n        startActivity(de);\n    }\n}",
    "classes": [
      {
        "parent_file": null,
        "name": "PendingBeneficiary",
        "position": {
          "start_line": 34,
          "end_line": 133,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class PendingBeneficiary extends AppCompatActivity implements Padapter.OnItemClickListener{\n    public static final String id=\"id\";\n    RecyclerView recyclerView;\n    List<PendingBeneficiaryRecords> precords;\n    private TextView emptyView;\n    Padapter padapter;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_pendingbenificiary);\n        recyclerView=findViewById(R.id.pendb);\n        precords=new ArrayList<>();\n        emptyView = findViewById(R.id.empty_view);\n        getPendingBeneficiaries();\n    }\n\n    public void getPendingBeneficiaries(){\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint = \"/api/beneficiary/pending\";\n        String finalUrl = url + endpoint;\n        RequestQueue queue = Volley.newRequestQueue(this);\n        JsonObjectRequest jsonArrayRequest=new JsonObjectRequest(Request.Method.POST, finalUrl, null,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            Log.d(\"Pending Beneficiary\", decryptedResponse.toString());\n//                            Log.d(\"Pending Beneficiary\", decryptedResponse.getJSONObject(\"status\").getInt(\"code\"));\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONArray jsonArray = decryptedResponse .getJSONArray(\"data\");\n\n                            for(int i=0; i < jsonArray.length(); i++) {\n\n                                JSONObject transrecobject = jsonArray.getJSONObject(i);\n                                PendingBeneficiaryRecords precorder = new PendingBeneficiaryRecords();\n                                precorder.setAccountNumber(transrecobject.getString(\"account_number\").toString());\n                                precorder.setBeneficiaryAccountNumber(transrecobject.getString(\"beneficiary_account_number\").toString());\n                                precorder.setId(transrecobject.getString(\"id\").toString());\n                                precords.add(precorder);\n                            }\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n                        recyclerView.setLayoutManager(new LinearLayoutManager(getApplicationContext()));\n                        padapter = new Padapter(getApplicationContext(),precords);\n                        recyclerView.setAdapter(padapter);\n                        padapter.setOnItemClickListener(PendingBeneficiary.this);\n                        Integer count=padapter.getItemCount();\n                        if (count == 0) {\n                            recyclerView.setVisibility(View.GONE);\n                            emptyView.setVisibility(View.VISIBLE);\n                        }\n                        else {\n                            recyclerView.setVisibility(View.VISIBLE);\n                            emptyView.setVisibility(View.GONE);\n                        }\n\n                    }\n\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers = new HashMap();\n                headers.put(\"Authorization\",\"Bearer \" + retrivedToken);\n                return headers;\n            }};\n\n        queue.add(jsonArrayRequest);\n        queue.getCache().clear();\n    }\n\n    @Override\n    public void onItemClick(int position) {\n        Intent de=new Intent(this, ApproveBeneficiary.class);\n        PendingBeneficiaryRecords cf =precords.get(position);\n        de.putExtra(id,cf.getId());\n        startActivity(de);\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "onCreate",
            "return_type": "void",
            "position": {
              "start_line": 41,
              "end_line": 49,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_pendingbenificiary);\n        recyclerView=findViewById(R.id.pendb);\n        precords=new ArrayList<>();\n        emptyView = findViewById(R.id.empty_view);\n        getPendingBeneficiaries();\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getPendingBeneficiaries",
            "return_type": "void",
            "position": {
              "start_line": 51,
              "end_line": 124,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void getPendingBeneficiaries(){\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint = \"/api/beneficiary/pending\";\n        String finalUrl = url + endpoint;\n        RequestQueue queue = Volley.newRequestQueue(this);\n        JsonObjectRequest jsonArrayRequest=new JsonObjectRequest(Request.Method.POST, finalUrl, null,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            Log.d(\"Pending Beneficiary\", decryptedResponse.toString());\n//                            Log.d(\"Pending Beneficiary\", decryptedResponse.getJSONObject(\"status\").getInt(\"code\"));\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONArray jsonArray = decryptedResponse .getJSONArray(\"data\");\n\n                            for(int i=0; i < jsonArray.length(); i++) {\n\n                                JSONObject transrecobject = jsonArray.getJSONObject(i);\n                                PendingBeneficiaryRecords precorder = new PendingBeneficiaryRecords();\n                                precorder.setAccountNumber(transrecobject.getString(\"account_number\").toString());\n                                precorder.setBeneficiaryAccountNumber(transrecobject.getString(\"beneficiary_account_number\").toString());\n                                precorder.setId(transrecobject.getString(\"id\").toString());\n                                precords.add(precorder);\n                            }\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n                        recyclerView.setLayoutManager(new LinearLayoutManager(getApplicationContext()));\n                        padapter = new Padapter(getApplicationContext(),precords);\n                        recyclerView.setAdapter(padapter);\n                        padapter.setOnItemClickListener(PendingBeneficiary.this);\n                        Integer count=padapter.getItemCount();\n                        if (count == 0) {\n                            recyclerView.setVisibility(View.GONE);\n                            emptyView.setVisibility(View.VISIBLE);\n                        }\n                        else {\n                            recyclerView.setVisibility(View.VISIBLE);\n                            emptyView.setVisibility(View.GONE);\n                        }\n\n                    }\n\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers = new HashMap();\n                headers.put(\"Authorization\",\"Bearer \" + retrivedToken);\n                return headers;\n            }};\n\n        queue.add(jsonArrayRequest);\n        queue.getCache().clear();\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onResponse",
            "return_type": "void",
            "position": {
              "start_line": 59,
              "end_line": 105,
              "start_column": 20,
              "end_column": 21
            },
            "code": "@Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            Log.d(\"Pending Beneficiary\", decryptedResponse.toString());\n//                            Log.d(\"Pending Beneficiary\", decryptedResponse.getJSONObject(\"status\").getInt(\"code\"));\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONArray jsonArray = decryptedResponse .getJSONArray(\"data\");\n\n                            for(int i=0; i < jsonArray.length(); i++) {\n\n                                JSONObject transrecobject = jsonArray.getJSONObject(i);\n                                PendingBeneficiaryRecords precorder = new PendingBeneficiaryRecords();\n                                precorder.setAccountNumber(transrecobject.getString(\"account_number\").toString());\n                                precorder.setBeneficiaryAccountNumber(transrecobject.getString(\"beneficiary_account_number\").toString());\n                                precorder.setId(transrecobject.getString(\"id\").toString());\n                                precords.add(precorder);\n                            }\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n                        recyclerView.setLayoutManager(new LinearLayoutManager(getApplicationContext()));\n                        padapter = new Padapter(getApplicationContext(),precords);\n                        recyclerView.setAdapter(padapter);\n                        padapter.setOnItemClickListener(PendingBeneficiary.this);\n                        Integer count=padapter.getItemCount();\n                        if (count == 0) {\n                            recyclerView.setVisibility(View.GONE);\n                            emptyView.setVisibility(View.VISIBLE);\n                        }\n                        else {\n                            recyclerView.setVisibility(View.VISIBLE);\n                            emptyView.setVisibility(View.GONE);\n                        }\n\n                    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onErrorResponse",
            "return_type": "void",
            "position": {
              "start_line": 108,
              "end_line": 111,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getHeaders",
            "return_type": "Map",
            "position": {
              "start_line": 113,
              "end_line": 120,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers = new HashMap();\n                headers.put(\"Authorization\",\"Bearer \" + retrivedToken);\n                return headers;\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onItemClick",
            "return_type": "void",
            "position": {
              "start_line": 126,
              "end_line": 132,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    public void onItemClick(int position) {\n        Intent de=new Intent(this, ApproveBeneficiary.class);\n        PendingBeneficiaryRecords cf =precords.get(position);\n        de.putExtra(id,cf.getId());\n        startActivity(de);\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/RegisterBank.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport android.content.Context;\nimport android.content.Intent;\nimport android.content.SharedPreferences;\nimport android.os.Bundle;\nimport android.view.View;\nimport android.widget.EditText;\nimport android.widget.Toast;\n\nimport com.android.volley.Request;\nimport com.android.volley.RequestQueue;\nimport com.android.volley.Response;\nimport com.android.volley.VolleyError;\nimport com.android.volley.toolbox.JsonObjectRequest;\nimport com.android.volley.toolbox.Volley;\nimport com.google.firebase.auth.FirebaseAuth;\n\nimport org.json.JSONException;\nimport org.json.JSONObject;\n\npublic class RegisterBank extends AppCompatActivity {\n    FirebaseAuth auth;\n\n    public void backToMain(View view){\n        Intent intent =new Intent(RegisterBank.this, MainActivity.class);\n        startActivity(intent);\n    }\n    public void register(View view)\n    {\n        EditText inputEmail=findViewById(R.id.signupemail_editText);\n        EditText inputPassword=findViewById(R.id.signup_password_editText);\n\n        String email = inputEmail.getText().toString().trim();\n        String password = inputPassword.getText().toString().trim();\n\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint = \"/api/user/register\";\n        String finalUrl = url + endpoint;\n\n        final RequestQueue requestQueue = Volley.newRequestQueue(getApplicationContext());\n        JSONObject requestData = new JSONObject();\n        JSONObject requestDataEncrypted = new JSONObject();\n        try {\n            //input your API parameters\n            requestData.put(\"username\", email);\n            requestData.put(\"password\", password);\n\n            // Encrypt data before sending\n            requestDataEncrypted.put(\"enc_data\", EncryptDecrypt.encrypt(requestData.toString()));\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        // Enter the correct url for your api service site\n        final JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(Request.Method.POST, finalUrl, requestDataEncrypted,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n                        try {\n                            Toast.makeText(getApplicationContext(), \"User created\" + EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()), Toast.LENGTH_SHORT).show();\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n                        startActivity(new Intent(RegisterBank.this, BankLogin.class));\n\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"You did something wrong\", Toast.LENGTH_SHORT).show();\n            }\n        });\n        requestQueue.add(jsonObjectRequest);\n\n\n\n\n    }\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_signup);\n    }\n\n}",
    "classes": [
      {
        "parent_file": null,
        "name": "RegisterBank",
        "position": {
          "start_line": 24,
          "end_line": 88,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class RegisterBank extends AppCompatActivity {\n    FirebaseAuth auth;\n\n    public void backToMain(View view){\n        Intent intent =new Intent(RegisterBank.this, MainActivity.class);\n        startActivity(intent);\n    }\n    public void register(View view)\n    {\n        EditText inputEmail=findViewById(R.id.signupemail_editText);\n        EditText inputPassword=findViewById(R.id.signup_password_editText);\n\n        String email = inputEmail.getText().toString().trim();\n        String password = inputPassword.getText().toString().trim();\n\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint = \"/api/user/register\";\n        String finalUrl = url + endpoint;\n\n        final RequestQueue requestQueue = Volley.newRequestQueue(getApplicationContext());\n        JSONObject requestData = new JSONObject();\n        JSONObject requestDataEncrypted = new JSONObject();\n        try {\n            //input your API parameters\n            requestData.put(\"username\", email);\n            requestData.put(\"password\", password);\n\n            // Encrypt data before sending\n            requestDataEncrypted.put(\"enc_data\", EncryptDecrypt.encrypt(requestData.toString()));\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        // Enter the correct url for your api service site\n        final JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(Request.Method.POST, finalUrl, requestDataEncrypted,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n                        try {\n                            Toast.makeText(getApplicationContext(), \"User created\" + EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()), Toast.LENGTH_SHORT).show();\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n                        startActivity(new Intent(RegisterBank.this, BankLogin.class));\n\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"You did something wrong\", Toast.LENGTH_SHORT).show();\n            }\n        });\n        requestQueue.add(jsonObjectRequest);\n\n\n\n\n    }\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_signup);\n    }\n\n}",
        "summary": "",
        "methods": [
          {
            "name": "backToMain",
            "return_type": "void",
            "position": {
              "start_line": 27,
              "end_line": 30,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void backToMain(View view){\n        Intent intent =new Intent(RegisterBank.this, MainActivity.class);\n        startActivity(intent);\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "register",
            "return_type": "void",
            "position": {
              "start_line": 31,
              "end_line": 81,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void register(View view)\n    {\n        EditText inputEmail=findViewById(R.id.signupemail_editText);\n        EditText inputPassword=findViewById(R.id.signup_password_editText);\n\n        String email = inputEmail.getText().toString().trim();\n        String password = inputPassword.getText().toString().trim();\n\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint = \"/api/user/register\";\n        String finalUrl = url + endpoint;\n\n        final RequestQueue requestQueue = Volley.newRequestQueue(getApplicationContext());\n        JSONObject requestData = new JSONObject();\n        JSONObject requestDataEncrypted = new JSONObject();\n        try {\n            //input your API parameters\n            requestData.put(\"username\", email);\n            requestData.put(\"password\", password);\n\n            // Encrypt data before sending\n            requestDataEncrypted.put(\"enc_data\", EncryptDecrypt.encrypt(requestData.toString()));\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        // Enter the correct url for your api service site\n        final JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(Request.Method.POST, finalUrl, requestDataEncrypted,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n                        try {\n                            Toast.makeText(getApplicationContext(), \"User created\" + EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()), Toast.LENGTH_SHORT).show();\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n                        startActivity(new Intent(RegisterBank.this, BankLogin.class));\n\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"You did something wrong\", Toast.LENGTH_SHORT).show();\n            }\n        });\n        requestQueue.add(jsonObjectRequest);\n\n\n\n\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onResponse",
            "return_type": "void",
            "position": {
              "start_line": 60,
              "end_line": 69,
              "start_column": 20,
              "end_column": 21
            },
            "code": "@Override\n                    public void onResponse(JSONObject response) {\n                        try {\n                            Toast.makeText(getApplicationContext(), \"User created\" + EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()), Toast.LENGTH_SHORT).show();\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n                        startActivity(new Intent(RegisterBank.this, BankLogin.class));\n\n                    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onErrorResponse",
            "return_type": "void",
            "position": {
              "start_line": 71,
              "end_line": 74,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"You did something wrong\", Toast.LENGTH_SHORT).show();\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onCreate",
            "return_type": "void",
            "position": {
              "start_line": 82,
              "end_line": 86,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_signup);\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/Badapter.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport android.content.Context;\nimport android.view.LayoutInflater;\nimport android.view.View;\nimport android.view.ViewGroup;\nimport android.widget.TextView;\n\nimport androidx.annotation.NonNull;\nimport androidx.recyclerview.widget.RecyclerView;\n\nimport java.util.List;\n\npublic class Badapter extends RecyclerView.Adapter<Badapter.ViewHolder> {\n\n    LayoutInflater inflater;\n    List<BeneficiaryRecords> brecords;\n    private OnItemClickListener mListener;\n\n    public interface OnItemClickListener{\n        void onItemClick(int position);\n    }\n\n    public void setOnItemClickListener(OnItemClickListener listener){\n        mListener =listener;\n    }\n\n    public Badapter(Context ctx,List<BeneficiaryRecords> brecords){\n        this.inflater=LayoutInflater.from(ctx);\n        this.brecords=brecords;\n    }\n\n    @NonNull\n    @Override\n    public ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\n        View view =inflater.inflate(R.layout.custom_benif,parent,false);\n        return  new ViewHolder(view);\n    }\n\n    @Override\n    public void onBindViewHolder(@NonNull ViewHolder holder, int position) {\n        holder.benificiaryaccnt.setText(brecords.get(position).getBeneficiaryAccount());\n        holder.isapproved.setText(brecords.get(position).getIsApproved());\n\n\n    }\n\n    @Override\n    public int getItemCount() {\n        return brecords.size();\n    }\n\n    public class ViewHolder extends  RecyclerView.ViewHolder{\n        TextView benificiaryaccnt,isapproved;\n\n        public ViewHolder(@NonNull View itemView) {\n            super(itemView);\n\n            benificiaryaccnt=itemView.findViewById(R.id.benif);\n            isapproved=itemView.findViewById(R.id.isapproved);\n\n            itemView.setOnClickListener(new View.OnClickListener() {\n                @Override\n                public void onClick(View v) {\n                    if(mListener != null){\n                        int position =getAdapterPosition();\n                        if(position !=RecyclerView.NO_POSITION){\n                            mListener.onItemClick(position);\n                        }\n                    }\n                }\n            });\n\n        }\n    }\n}\n",
    "classes": [
      {
        "parent_file": null,
        "name": "Badapter",
        "position": {
          "start_line": 14,
          "end_line": 76,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class Badapter extends RecyclerView.Adapter<Badapter.ViewHolder> {\n\n    LayoutInflater inflater;\n    List<BeneficiaryRecords> brecords;\n    private OnItemClickListener mListener;\n\n    public interface OnItemClickListener{\n        void onItemClick(int position);\n    }\n\n    public void setOnItemClickListener(OnItemClickListener listener){\n        mListener =listener;\n    }\n\n    public Badapter(Context ctx,List<BeneficiaryRecords> brecords){\n        this.inflater=LayoutInflater.from(ctx);\n        this.brecords=brecords;\n    }\n\n    @NonNull\n    @Override\n    public ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\n        View view =inflater.inflate(R.layout.custom_benif,parent,false);\n        return  new ViewHolder(view);\n    }\n\n    @Override\n    public void onBindViewHolder(@NonNull ViewHolder holder, int position) {\n        holder.benificiaryaccnt.setText(brecords.get(position).getBeneficiaryAccount());\n        holder.isapproved.setText(brecords.get(position).getIsApproved());\n\n\n    }\n\n    @Override\n    public int getItemCount() {\n        return brecords.size();\n    }\n\n    public class ViewHolder extends  RecyclerView.ViewHolder{\n        TextView benificiaryaccnt,isapproved;\n\n        public ViewHolder(@NonNull View itemView) {\n            super(itemView);\n\n            benificiaryaccnt=itemView.findViewById(R.id.benif);\n            isapproved=itemView.findViewById(R.id.isapproved);\n\n            itemView.setOnClickListener(new View.OnClickListener() {\n                @Override\n                public void onClick(View v) {\n                    if(mListener != null){\n                        int position =getAdapterPosition();\n                        if(position !=RecyclerView.NO_POSITION){\n                            mListener.onItemClick(position);\n                        }\n                    }\n                }\n            });\n\n        }\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "onItemClick",
            "return_type": "void",
            "position": {
              "start_line": 21,
              "end_line": 21,
              "start_column": 8,
              "end_column": 39
            },
            "code": "void onItemClick(int position);",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "setOnItemClickListener",
            "return_type": "void",
            "position": {
              "start_line": 24,
              "end_line": 26,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void setOnItemClickListener(OnItemClickListener listener){\n        mListener =listener;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onCreateViewHolder",
            "return_type": "ViewHolder",
            "position": {
              "start_line": 33,
              "end_line": 38,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@NonNull\n    @Override\n    public ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\n        View view =inflater.inflate(R.layout.custom_benif,parent,false);\n        return  new ViewHolder(view);\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onBindViewHolder",
            "return_type": "void",
            "position": {
              "start_line": 40,
              "end_line": 46,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    public void onBindViewHolder(@NonNull ViewHolder holder, int position) {\n        holder.benificiaryaccnt.setText(brecords.get(position).getBeneficiaryAccount());\n        holder.isapproved.setText(brecords.get(position).getIsApproved());\n\n\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getItemCount",
            "return_type": "int",
            "position": {
              "start_line": 48,
              "end_line": 51,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    public int getItemCount() {\n        return brecords.size();\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onClick",
            "return_type": "void",
            "position": {
              "start_line": 63,
              "end_line": 71,
              "start_column": 16,
              "end_column": 17
            },
            "code": "@Override\n                public void onClick(View v) {\n                    if(mListener != null){\n                        int position =getAdapterPosition();\n                        if(position !=RecyclerView.NO_POSITION){\n                            mListener.onItemClick(position);\n                        }\n                    }\n                }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      },
      {
        "parent_file": null,
        "name": "ViewHolder",
        "position": {
          "start_line": 53,
          "end_line": 75,
          "start_column": 4,
          "end_column": 5
        },
        "code": "public class ViewHolder extends  RecyclerView.ViewHolder{\n        TextView benificiaryaccnt,isapproved;\n\n        public ViewHolder(@NonNull View itemView) {\n            super(itemView);\n\n            benificiaryaccnt=itemView.findViewById(R.id.benif);\n            isapproved=itemView.findViewById(R.id.isapproved);\n\n            itemView.setOnClickListener(new View.OnClickListener() {\n                @Override\n                public void onClick(View v) {\n                    if(mListener != null){\n                        int position =getAdapterPosition();\n                        if(position !=RecyclerView.NO_POSITION){\n                            mListener.onItemClick(position);\n                        }\n                    }\n                }\n            });\n\n        }\n    }",
        "summary": "",
        "methods": [
          {
            "name": "onClick",
            "return_type": "void",
            "position": {
              "start_line": 63,
              "end_line": 71,
              "start_column": 16,
              "end_column": 17
            },
            "code": "@Override\n                public void onClick(View v) {\n                    if(mListener != null){\n                        int position =getAdapterPosition();\n                        if(position !=RecyclerView.NO_POSITION){\n                            mListener.onItemClick(position);\n                        }\n                    }\n                }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/ViewBeneficiaryAdmin.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport androidx.appcompat.app.AppCompatActivity;\nimport androidx.recyclerview.widget.LinearLayoutManager;\nimport androidx.recyclerview.widget.RecyclerView;\n\nimport android.content.Context;\nimport android.content.Intent;\nimport android.content.SharedPreferences;\nimport android.os.Bundle;\nimport android.view.View;\nimport android.widget.TextView;\nimport android.widget.Toast;\n\nimport com.android.volley.AuthFailureError;\nimport com.android.volley.Request;\nimport com.android.volley.RequestQueue;\nimport com.android.volley.Response;\nimport com.android.volley.VolleyError;\nimport com.android.volley.toolbox.JsonObjectRequest;\nimport com.android.volley.toolbox.Volley;\n\nimport org.json.JSONArray;\nimport org.json.JSONException;\nimport org.json.JSONObject;\n\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\npublic class ViewBeneficiaryAdmin extends AppCompatActivity  implements Badapter.OnItemClickListener {\npublic static final String beneficiary_account_number=\"beneficiary_account_number\";\n    RecyclerView recyclerView;\n    List<BeneficiaryRecords> brecords;\n    private TextView emptyView;\n    Badapter badapter;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_viewbenif);\n        recyclerView=findViewById(R.id.benif);\n        emptyView=findViewById(R.id.empty_view);\n        brecords=new ArrayList<>();\n        viewBeneficiaries();\n    }\n    public void viewBeneficiaries(){\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint = \"/api/beneficiary/view\";\n        final String finalurl = url+endpoint;\n        RequestQueue queue = Volley.newRequestQueue(this);\n        JsonObjectRequest jsonArrayRequest=new JsonObjectRequest(Request.Method.POST, finalurl, null,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONArray jsonArray=decryptedResponse.getJSONArray(\"data\");\n                            for(int i=0;i<jsonArray.length();i++) {\n                                JSONObject transrecobject = jsonArray.getJSONObject(i);\n                                BeneficiaryRecords brecorder = new BeneficiaryRecords();\n                                String approved=transrecobject.getString(\"approved\").toString();\n                                if(approved==\"false\")\n                                {continue;}\n                                else{\n                                brecorder.setBeneficiaryAccount(transrecobject.getString(\"beneficiary_account_number\").toString());\n                                //brecorder.setIsapproved(transrecobject.getString(\"approved\").toString());\n                                brecords.add(brecorder);}\n                            }\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n                        recyclerView.setLayoutManager(new LinearLayoutManager(getApplicationContext()));\n                        badapter=new Badapter(getApplicationContext(),brecords);\n                        recyclerView.setAdapter(badapter);\n\n                        Integer count=badapter.getItemCount();\n                        if (count == 0) {\n                            recyclerView.setVisibility(View.GONE);\n                            emptyView.setVisibility(View.VISIBLE);\n                        }\n                        else {\n                            recyclerView.setVisibility(View.VISIBLE);\n                            emptyView.setVisibility(View.GONE);\n                        }\n                        badapter.setOnItemClickListener(ViewBeneficiaryAdmin.this);\n                    }\n\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }};\n\n        queue.add(jsonArrayRequest);\n        queue.getCache().clear();\n    }\n\n    @Override\n    public void onItemClick(int position) {\n        Intent de=new Intent(this, SendMoney.class);\n        BeneficiaryRecords cf =brecords.get(position);\n\n        de.putExtra(beneficiary_account_number,cf.getBeneficiaryAccount());\n        startActivity(de);\n    }\n}",
    "classes": [
      {
        "parent_file": null,
        "name": "ViewBeneficiaryAdmin",
        "position": {
          "start_line": 32,
          "end_line": 129,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class ViewBeneficiaryAdmin extends AppCompatActivity  implements Badapter.OnItemClickListener {\npublic static final String beneficiary_account_number=\"beneficiary_account_number\";\n    RecyclerView recyclerView;\n    List<BeneficiaryRecords> brecords;\n    private TextView emptyView;\n    Badapter badapter;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_viewbenif);\n        recyclerView=findViewById(R.id.benif);\n        emptyView=findViewById(R.id.empty_view);\n        brecords=new ArrayList<>();\n        viewBeneficiaries();\n    }\n    public void viewBeneficiaries(){\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint = \"/api/beneficiary/view\";\n        final String finalurl = url+endpoint;\n        RequestQueue queue = Volley.newRequestQueue(this);\n        JsonObjectRequest jsonArrayRequest=new JsonObjectRequest(Request.Method.POST, finalurl, null,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONArray jsonArray=decryptedResponse.getJSONArray(\"data\");\n                            for(int i=0;i<jsonArray.length();i++) {\n                                JSONObject transrecobject = jsonArray.getJSONObject(i);\n                                BeneficiaryRecords brecorder = new BeneficiaryRecords();\n                                String approved=transrecobject.getString(\"approved\").toString();\n                                if(approved==\"false\")\n                                {continue;}\n                                else{\n                                brecorder.setBeneficiaryAccount(transrecobject.getString(\"beneficiary_account_number\").toString());\n                                //brecorder.setIsapproved(transrecobject.getString(\"approved\").toString());\n                                brecords.add(brecorder);}\n                            }\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n                        recyclerView.setLayoutManager(new LinearLayoutManager(getApplicationContext()));\n                        badapter=new Badapter(getApplicationContext(),brecords);\n                        recyclerView.setAdapter(badapter);\n\n                        Integer count=badapter.getItemCount();\n                        if (count == 0) {\n                            recyclerView.setVisibility(View.GONE);\n                            emptyView.setVisibility(View.VISIBLE);\n                        }\n                        else {\n                            recyclerView.setVisibility(View.VISIBLE);\n                            emptyView.setVisibility(View.GONE);\n                        }\n                        badapter.setOnItemClickListener(ViewBeneficiaryAdmin.this);\n                    }\n\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }};\n\n        queue.add(jsonArrayRequest);\n        queue.getCache().clear();\n    }\n\n    @Override\n    public void onItemClick(int position) {\n        Intent de=new Intent(this, SendMoney.class);\n        BeneficiaryRecords cf =brecords.get(position);\n\n        de.putExtra(beneficiary_account_number,cf.getBeneficiaryAccount());\n        startActivity(de);\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "onCreate",
            "return_type": "void",
            "position": {
              "start_line": 39,
              "end_line": 47,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_viewbenif);\n        recyclerView=findViewById(R.id.benif);\n        emptyView=findViewById(R.id.empty_view);\n        brecords=new ArrayList<>();\n        viewBeneficiaries();\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "viewBeneficiaries",
            "return_type": "void",
            "position": {
              "start_line": 48,
              "end_line": 119,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void viewBeneficiaries(){\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint = \"/api/beneficiary/view\";\n        final String finalurl = url+endpoint;\n        RequestQueue queue = Volley.newRequestQueue(this);\n        JsonObjectRequest jsonArrayRequest=new JsonObjectRequest(Request.Method.POST, finalurl, null,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONArray jsonArray=decryptedResponse.getJSONArray(\"data\");\n                            for(int i=0;i<jsonArray.length();i++) {\n                                JSONObject transrecobject = jsonArray.getJSONObject(i);\n                                BeneficiaryRecords brecorder = new BeneficiaryRecords();\n                                String approved=transrecobject.getString(\"approved\").toString();\n                                if(approved==\"false\")\n                                {continue;}\n                                else{\n                                brecorder.setBeneficiaryAccount(transrecobject.getString(\"beneficiary_account_number\").toString());\n                                //brecorder.setIsapproved(transrecobject.getString(\"approved\").toString());\n                                brecords.add(brecorder);}\n                            }\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n                        recyclerView.setLayoutManager(new LinearLayoutManager(getApplicationContext()));\n                        badapter=new Badapter(getApplicationContext(),brecords);\n                        recyclerView.setAdapter(badapter);\n\n                        Integer count=badapter.getItemCount();\n                        if (count == 0) {\n                            recyclerView.setVisibility(View.GONE);\n                            emptyView.setVisibility(View.VISIBLE);\n                        }\n                        else {\n                            recyclerView.setVisibility(View.VISIBLE);\n                            emptyView.setVisibility(View.GONE);\n                        }\n                        badapter.setOnItemClickListener(ViewBeneficiaryAdmin.this);\n                    }\n\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }};\n\n        queue.add(jsonArrayRequest);\n        queue.getCache().clear();\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onResponse",
            "return_type": "void",
            "position": {
              "start_line": 56,
              "end_line": 100,
              "start_column": 20,
              "end_column": 21
            },
            "code": "@Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONArray jsonArray=decryptedResponse.getJSONArray(\"data\");\n                            for(int i=0;i<jsonArray.length();i++) {\n                                JSONObject transrecobject = jsonArray.getJSONObject(i);\n                                BeneficiaryRecords brecorder = new BeneficiaryRecords();\n                                String approved=transrecobject.getString(\"approved\").toString();\n                                if(approved==\"false\")\n                                {continue;}\n                                else{\n                                brecorder.setBeneficiaryAccount(transrecobject.getString(\"beneficiary_account_number\").toString());\n                                //brecorder.setIsapproved(transrecobject.getString(\"approved\").toString());\n                                brecords.add(brecorder);}\n                            }\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n                        recyclerView.setLayoutManager(new LinearLayoutManager(getApplicationContext()));\n                        badapter=new Badapter(getApplicationContext(),brecords);\n                        recyclerView.setAdapter(badapter);\n\n                        Integer count=badapter.getItemCount();\n                        if (count == 0) {\n                            recyclerView.setVisibility(View.GONE);\n                            emptyView.setVisibility(View.VISIBLE);\n                        }\n                        else {\n                            recyclerView.setVisibility(View.VISIBLE);\n                            emptyView.setVisibility(View.GONE);\n                        }\n                        badapter.setOnItemClickListener(ViewBeneficiaryAdmin.this);\n                    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onErrorResponse",
            "return_type": "void",
            "position": {
              "start_line": 103,
              "end_line": 106,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getHeaders",
            "return_type": "Map",
            "position": {
              "start_line": 108,
              "end_line": 115,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public Map getHeaders() throws AuthFailureError {\n                SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onItemClick",
            "return_type": "void",
            "position": {
              "start_line": 121,
              "end_line": 128,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    public void onItemClick(int position) {\n        Intent de=new Intent(this, SendMoney.class);\n        BeneficiaryRecords cf =brecords.get(position);\n\n        de.putExtra(beneficiary_account_number,cf.getBeneficiaryAccount());\n        startActivity(de);\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/AddBeneficiary.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport android.content.Context;\nimport android.content.Intent;\nimport android.content.SharedPreferences;\nimport android.os.Bundle;\nimport android.view.View;\nimport android.widget.EditText;\nimport android.widget.Toast;\n\nimport com.android.volley.AuthFailureError;\nimport com.android.volley.Request;\nimport com.android.volley.RequestQueue;\nimport com.android.volley.Response;\nimport com.android.volley.VolleyError;\nimport com.android.volley.toolbox.JsonObjectRequest;\nimport com.android.volley.toolbox.Volley;\n\nimport org.json.JSONException;\nimport org.json.JSONObject;\n\nimport java.util.HashMap;\nimport java.util.Map;\n\npublic class AddBeneficiary extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_addbenif);\n\n\n    }\n\n    public void addBeneficiary(View view){\n        SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n        final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n        EditText ed=findViewById(R.id.edt);\n        final String edd=ed.getText().toString().trim();\n        sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint=\"/api/beneficiary/add\";\n        String finalurl = url+endpoint;\n        final RequestQueue requestQueue = Volley.newRequestQueue(getApplicationContext());\n        JSONObject requestData = new JSONObject();\n        JSONObject requestDataEncrypted = new JSONObject();\n        try {\n            //input your API parameters\n            requestData.put(\"account_number\",edd);\n\n            // Encrypt the data before sending\n            requestDataEncrypted.put(\"enc_data\", EncryptDecrypt.encrypt(requestData.toString()));\n\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        // Enter the correct url for your api service site\n        final JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(Request.Method.POST, finalurl, requestDataEncrypted,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n                            Toast.makeText(getApplicationContext(), EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()), Toast.LENGTH_SHORT).show();\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n                        startActivity(new Intent(AddBeneficiary.this, Dashboard.class));\n\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }\n\n\n        };\n        requestQueue.add(jsonObjectRequest);\n\n\n    }\n}",
    "classes": [
      {
        "parent_file": null,
        "name": "AddBeneficiary",
        "position": {
          "start_line": 27,
          "end_line": 92,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class AddBeneficiary extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_addbenif);\n\n\n    }\n\n    public void addBeneficiary(View view){\n        SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n        final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n        EditText ed=findViewById(R.id.edt);\n        final String edd=ed.getText().toString().trim();\n        sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint=\"/api/beneficiary/add\";\n        String finalurl = url+endpoint;\n        final RequestQueue requestQueue = Volley.newRequestQueue(getApplicationContext());\n        JSONObject requestData = new JSONObject();\n        JSONObject requestDataEncrypted = new JSONObject();\n        try {\n            //input your API parameters\n            requestData.put(\"account_number\",edd);\n\n            // Encrypt the data before sending\n            requestDataEncrypted.put(\"enc_data\", EncryptDecrypt.encrypt(requestData.toString()));\n\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        // Enter the correct url for your api service site\n        final JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(Request.Method.POST, finalurl, requestDataEncrypted,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n                            Toast.makeText(getApplicationContext(), EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()), Toast.LENGTH_SHORT).show();\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n                        startActivity(new Intent(AddBeneficiary.this, Dashboard.class));\n\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }\n\n\n        };\n        requestQueue.add(jsonObjectRequest);\n\n\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "onCreate",
            "return_type": "void",
            "position": {
              "start_line": 29,
              "end_line": 35,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_addbenif);\n\n\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "addBeneficiary",
            "return_type": "void",
            "position": {
              "start_line": 37,
              "end_line": 91,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void addBeneficiary(View view){\n        SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n        final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n        EditText ed=findViewById(R.id.edt);\n        final String edd=ed.getText().toString().trim();\n        sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint=\"/api/beneficiary/add\";\n        String finalurl = url+endpoint;\n        final RequestQueue requestQueue = Volley.newRequestQueue(getApplicationContext());\n        JSONObject requestData = new JSONObject();\n        JSONObject requestDataEncrypted = new JSONObject();\n        try {\n            //input your API parameters\n            requestData.put(\"account_number\",edd);\n\n            // Encrypt the data before sending\n            requestDataEncrypted.put(\"enc_data\", EncryptDecrypt.encrypt(requestData.toString()));\n\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        // Enter the correct url for your api service site\n        final JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(Request.Method.POST, finalurl, requestDataEncrypted,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n                            Toast.makeText(getApplicationContext(), EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()), Toast.LENGTH_SHORT).show();\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n                        startActivity(new Intent(AddBeneficiary.this, Dashboard.class));\n\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }\n\n\n        };\n        requestQueue.add(jsonObjectRequest);\n\n\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onResponse",
            "return_type": "void",
            "position": {
              "start_line": 62,
              "end_line": 72,
              "start_column": 20,
              "end_column": 21
            },
            "code": "@Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n                            Toast.makeText(getApplicationContext(), EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()), Toast.LENGTH_SHORT).show();\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n                        startActivity(new Intent(AddBeneficiary.this, Dashboard.class));\n\n                    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onErrorResponse",
            "return_type": "void",
            "position": {
              "start_line": 74,
              "end_line": 77,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getHeaders",
            "return_type": "Map",
            "position": {
              "start_line": 79,
              "end_line": 84,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public Map getHeaders() throws AuthFailureError {\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/Adapter.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport android.content.Context;\nimport android.view.LayoutInflater;\nimport android.view.View;\nimport android.view.ViewGroup;\nimport android.widget.TextView;\n\nimport androidx.annotation.NonNull;\nimport androidx.recyclerview.widget.RecyclerView;\n\nimport java.util.List;\n\npublic class Adapter extends RecyclerView.Adapter<Adapter.ViewHolder> {\n\n    LayoutInflater inflater;\n    List<TransactionRecords> trecords;\n\n    public Adapter(Context ctx,List<TransactionRecords> trecords){\n        this.inflater=LayoutInflater.from(ctx);\n        this.trecords=trecords;\n    }\n\n    @NonNull\n    @Override\n    public ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\n        View view =inflater.inflate(R.layout.custom_list,parent,false);\n        return  new ViewHolder(view);\n    }\n\n    @Override\n    public void onBindViewHolder(@NonNull ViewHolder holder, int position) {\n        holder.fromacc.setText(trecords.get(position).getFromaccnt());\n        holder.toacc.setText(trecords.get(position).getToaccnt());\n        holder.amount.setText(trecords.get(position).getAmount());\n\n    }\n\n    @Override\n    public int getItemCount() {\n        return trecords.size();\n    }\n\n    public class ViewHolder extends  RecyclerView.ViewHolder{\n        TextView fromacc,toacc,amount;\n\n        public ViewHolder(@NonNull View itemView) {\n            super(itemView);\n            fromacc=itemView.findViewById(R.id.fromacc);\n            toacc=itemView.findViewById(R.id.toacc);\n            amount=itemView.findViewById(R.id.amount);\n        }\n    }\n}\n",
    "classes": [
      {
        "parent_file": null,
        "name": "Adapter",
        "position": {
          "start_line": 14,
          "end_line": 54,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class Adapter extends RecyclerView.Adapter<Adapter.ViewHolder> {\n\n    LayoutInflater inflater;\n    List<TransactionRecords> trecords;\n\n    public Adapter(Context ctx,List<TransactionRecords> trecords){\n        this.inflater=LayoutInflater.from(ctx);\n        this.trecords=trecords;\n    }\n\n    @NonNull\n    @Override\n    public ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\n        View view =inflater.inflate(R.layout.custom_list,parent,false);\n        return  new ViewHolder(view);\n    }\n\n    @Override\n    public void onBindViewHolder(@NonNull ViewHolder holder, int position) {\n        holder.fromacc.setText(trecords.get(position).getFromaccnt());\n        holder.toacc.setText(trecords.get(position).getToaccnt());\n        holder.amount.setText(trecords.get(position).getAmount());\n\n    }\n\n    @Override\n    public int getItemCount() {\n        return trecords.size();\n    }\n\n    public class ViewHolder extends  RecyclerView.ViewHolder{\n        TextView fromacc,toacc,amount;\n\n        public ViewHolder(@NonNull View itemView) {\n            super(itemView);\n            fromacc=itemView.findViewById(R.id.fromacc);\n            toacc=itemView.findViewById(R.id.toacc);\n            amount=itemView.findViewById(R.id.amount);\n        }\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "onCreateViewHolder",
            "return_type": "ViewHolder",
            "position": {
              "start_line": 24,
              "end_line": 29,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@NonNull\n    @Override\n    public ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\n        View view =inflater.inflate(R.layout.custom_list,parent,false);\n        return  new ViewHolder(view);\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onBindViewHolder",
            "return_type": "void",
            "position": {
              "start_line": 31,
              "end_line": 37,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    public void onBindViewHolder(@NonNull ViewHolder holder, int position) {\n        holder.fromacc.setText(trecords.get(position).getFromaccnt());\n        holder.toacc.setText(trecords.get(position).getToaccnt());\n        holder.amount.setText(trecords.get(position).getAmount());\n\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getItemCount",
            "return_type": "int",
            "position": {
              "start_line": 39,
              "end_line": 42,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    public int getItemCount() {\n        return trecords.size();\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      },
      {
        "parent_file": null,
        "name": "ViewHolder",
        "position": {
          "start_line": 44,
          "end_line": 53,
          "start_column": 4,
          "end_column": 5
        },
        "code": "public class ViewHolder extends  RecyclerView.ViewHolder{\n        TextView fromacc,toacc,amount;\n\n        public ViewHolder(@NonNull View itemView) {\n            super(itemView);\n            fromacc=itemView.findViewById(R.id.fromacc);\n            toacc=itemView.findViewById(R.id.toacc);\n            amount=itemView.findViewById(R.id.amount);\n        }\n    }",
        "summary": "",
        "methods": []
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/BankLogin.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport android.content.Context;\nimport android.content.Intent;\nimport android.content.SharedPreferences;\nimport android.os.Bundle;\nimport android.util.Log;\nimport android.view.View;\nimport android.widget.EditText;\nimport android.widget.ProgressBar;\nimport android.widget.RelativeLayout;\nimport android.widget.TextView;\nimport android.widget.Toast;\n\nimport com.android.volley.Request;\nimport com.android.volley.RequestQueue;\nimport com.android.volley.Response;\nimport com.android.volley.VolleyError;\nimport com.android.volley.toolbox.JsonObjectRequest;\nimport com.android.volley.toolbox.Volley;\n\nimport org.json.JSONException;\nimport org.json.JSONObject;\n\npublic class BankLogin extends AppCompatActivity {\n\n    private ProgressBar spinner;\n    private RelativeLayout priv;\n    public void backToMain(View view){\n        Intent into =new Intent(BankLogin.this, MainActivity.class);\n        startActivity(into);\n    }\n\n\n    public void bankLogin(View view)\n    {\n        final TextView t1 = findViewById(R.id.log);\n        EditText inputEmail = findViewById(R.id.loginemail_editText);\n        EditText inputPassword = findViewById(R.id.login_password_editText);\n        priv=(RelativeLayout)findViewById(R.id.relp);\n        spinner = (ProgressBar)findViewById(R.id.progressb);\n        priv.setVisibility(View.VISIBLE);\n        spinner.setVisibility(View.VISIBLE);\n        final String email = inputEmail.getText().toString().trim();\n        final String password = inputPassword.getText().toString().trim();\n\n\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint = \"/api/user/login\";\n        String finalurl = url + endpoint;\n\n        final RequestQueue requestQueue = Volley.newRequestQueue(getApplicationContext());\n        JSONObject requestData = new JSONObject();\n        JSONObject requestDataEncrypted = new JSONObject();\n        try {\n            // Input your API parameters\n            requestData.put(\"username\",email);\n            requestData.put(\"password\",password);\n\n            // Encrypt data before sending\n            requestDataEncrypted.put(\"enc_data\", EncryptDecrypt.encrypt(requestData.toString()));\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        // Enter the correct url for your api service site\n        final JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(Request.Method.POST, finalurl, requestDataEncrypted,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n                        try {\n\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                startActivity(new Intent(BankLogin.this, BankLogin.class));\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONObject obj = decryptedResponse.getJSONObject(\"data\");\n                            String accessToken=obj.getString(\"accessToken\");\n                            SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                            Log.d(\"accesstoken\",accessToken);\n                            sharedPreferences.edit().putString(\"accesstoken\",accessToken).apply();\n                            sharedPreferences.edit().putBoolean(\"isloggedin\",true).apply();\n                            startActivity(new Intent(BankLogin.this, Dashboard.class));\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n                startActivity(new Intent(BankLogin.this, BankLogin.class));\n            }\n        });\n        requestQueue.add(jsonObjectRequest);\n\n    }\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_login);\n\n    }\n}",
    "classes": [
      {
        "parent_file": null,
        "name": "BankLogin",
        "position": {
          "start_line": 27,
          "end_line": 115,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class BankLogin extends AppCompatActivity {\n\n    private ProgressBar spinner;\n    private RelativeLayout priv;\n    public void backToMain(View view){\n        Intent into =new Intent(BankLogin.this, MainActivity.class);\n        startActivity(into);\n    }\n\n\n    public void bankLogin(View view)\n    {\n        final TextView t1 = findViewById(R.id.log);\n        EditText inputEmail = findViewById(R.id.loginemail_editText);\n        EditText inputPassword = findViewById(R.id.login_password_editText);\n        priv=(RelativeLayout)findViewById(R.id.relp);\n        spinner = (ProgressBar)findViewById(R.id.progressb);\n        priv.setVisibility(View.VISIBLE);\n        spinner.setVisibility(View.VISIBLE);\n        final String email = inputEmail.getText().toString().trim();\n        final String password = inputPassword.getText().toString().trim();\n\n\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint = \"/api/user/login\";\n        String finalurl = url + endpoint;\n\n        final RequestQueue requestQueue = Volley.newRequestQueue(getApplicationContext());\n        JSONObject requestData = new JSONObject();\n        JSONObject requestDataEncrypted = new JSONObject();\n        try {\n            // Input your API parameters\n            requestData.put(\"username\",email);\n            requestData.put(\"password\",password);\n\n            // Encrypt data before sending\n            requestDataEncrypted.put(\"enc_data\", EncryptDecrypt.encrypt(requestData.toString()));\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        // Enter the correct url for your api service site\n        final JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(Request.Method.POST, finalurl, requestDataEncrypted,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n                        try {\n\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                startActivity(new Intent(BankLogin.this, BankLogin.class));\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONObject obj = decryptedResponse.getJSONObject(\"data\");\n                            String accessToken=obj.getString(\"accessToken\");\n                            SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                            Log.d(\"accesstoken\",accessToken);\n                            sharedPreferences.edit().putString(\"accesstoken\",accessToken).apply();\n                            sharedPreferences.edit().putBoolean(\"isloggedin\",true).apply();\n                            startActivity(new Intent(BankLogin.this, Dashboard.class));\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n                startActivity(new Intent(BankLogin.this, BankLogin.class));\n            }\n        });\n        requestQueue.add(jsonObjectRequest);\n\n    }\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_login);\n\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "backToMain",
            "return_type": "void",
            "position": {
              "start_line": 31,
              "end_line": 34,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void backToMain(View view){\n        Intent into =new Intent(BankLogin.this, MainActivity.class);\n        startActivity(into);\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "bankLogin",
            "return_type": "void",
            "position": {
              "start_line": 37,
              "end_line": 107,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void bankLogin(View view)\n    {\n        final TextView t1 = findViewById(R.id.log);\n        EditText inputEmail = findViewById(R.id.loginemail_editText);\n        EditText inputPassword = findViewById(R.id.login_password_editText);\n        priv=(RelativeLayout)findViewById(R.id.relp);\n        spinner = (ProgressBar)findViewById(R.id.progressb);\n        priv.setVisibility(View.VISIBLE);\n        spinner.setVisibility(View.VISIBLE);\n        final String email = inputEmail.getText().toString().trim();\n        final String password = inputPassword.getText().toString().trim();\n\n\n        SharedPreferences sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint = \"/api/user/login\";\n        String finalurl = url + endpoint;\n\n        final RequestQueue requestQueue = Volley.newRequestQueue(getApplicationContext());\n        JSONObject requestData = new JSONObject();\n        JSONObject requestDataEncrypted = new JSONObject();\n        try {\n            // Input your API parameters\n            requestData.put(\"username\",email);\n            requestData.put(\"password\",password);\n\n            // Encrypt data before sending\n            requestDataEncrypted.put(\"enc_data\", EncryptDecrypt.encrypt(requestData.toString()));\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        // Enter the correct url for your api service site\n        final JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(Request.Method.POST, finalurl, requestDataEncrypted,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n                        try {\n\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                startActivity(new Intent(BankLogin.this, BankLogin.class));\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONObject obj = decryptedResponse.getJSONObject(\"data\");\n                            String accessToken=obj.getString(\"accessToken\");\n                            SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                            Log.d(\"accesstoken\",accessToken);\n                            sharedPreferences.edit().putString(\"accesstoken\",accessToken).apply();\n                            sharedPreferences.edit().putBoolean(\"isloggedin\",true).apply();\n                            startActivity(new Intent(BankLogin.this, Dashboard.class));\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n                startActivity(new Intent(BankLogin.this, BankLogin.class));\n            }\n        });\n        requestQueue.add(jsonObjectRequest);\n\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onResponse",
            "return_type": "void",
            "position": {
              "start_line": 71,
              "end_line": 97,
              "start_column": 20,
              "end_column": 21
            },
            "code": "@Override\n                    public void onResponse(JSONObject response) {\n                        try {\n\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                startActivity(new Intent(BankLogin.this, BankLogin.class));\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONObject obj = decryptedResponse.getJSONObject(\"data\");\n                            String accessToken=obj.getString(\"accessToken\");\n                            SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n                            Log.d(\"accesstoken\",accessToken);\n                            sharedPreferences.edit().putString(\"accesstoken\",accessToken).apply();\n                            sharedPreferences.edit().putBoolean(\"isloggedin\",true).apply();\n                            startActivity(new Intent(BankLogin.this, Dashboard.class));\n\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n                    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onErrorResponse",
            "return_type": "void",
            "position": {
              "start_line": 99,
              "end_line": 103,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n                startActivity(new Intent(BankLogin.this, BankLogin.class));\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onCreate",
            "return_type": "void",
            "position": {
              "start_line": 109,
              "end_line": 114,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_login);\n\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/ViewBalance.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport android.content.Context;\nimport android.content.SharedPreferences;\nimport android.os.Bundle;\nimport android.widget.TextView;\nimport android.widget.Toast;\n\nimport com.android.volley.AuthFailureError;\nimport com.android.volley.Request;\nimport com.android.volley.RequestQueue;\nimport com.android.volley.Response;\nimport com.android.volley.VolleyError;\nimport com.android.volley.toolbox.JsonObjectRequest;\nimport com.android.volley.toolbox.Volley;\n\nimport org.json.JSONException;\nimport org.json.JSONObject;\n\nimport java.util.HashMap;\nimport java.util.Map;\n\npublic class ViewBalance extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_balanceview);\n        final TextView tv=findViewById(R.id.textView);\n        SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n        final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n        final RequestQueue queue = Volley.newRequestQueue(this);\n        sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint=\"/api/balance/view\";\n        String finalurl = url+endpoint;\n\n\n\n        final JsonObjectRequest stringRequest = new JsonObjectRequest(Request.Method.POST, finalurl,null,\n                new Response.Listener<JSONObject>()  {\n                    @Override\n                    public void onResponse(JSONObject response) {\n                        try {\n\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONObject obj = decryptedResponse.getJSONObject(\"data\");\n                            String accountid=obj.getString(\"account_number\");\n                            String balance =obj.getString(\"balance\");\n                            tv.setText(\"Your Balance is $\" + balance);\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError{\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }\n\n\n        };\n\n\n\n\n\n        queue.add(stringRequest);\n        queue.getCache().clear();\n\n\n\n    }\n}",
    "classes": [
      {
        "parent_file": null,
        "name": "ViewBalance",
        "position": {
          "start_line": 25,
          "end_line": 91,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class ViewBalance extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_balanceview);\n        final TextView tv=findViewById(R.id.textView);\n        SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n        final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n        final RequestQueue queue = Volley.newRequestQueue(this);\n        sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint=\"/api/balance/view\";\n        String finalurl = url+endpoint;\n\n\n\n        final JsonObjectRequest stringRequest = new JsonObjectRequest(Request.Method.POST, finalurl,null,\n                new Response.Listener<JSONObject>()  {\n                    @Override\n                    public void onResponse(JSONObject response) {\n                        try {\n\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONObject obj = decryptedResponse.getJSONObject(\"data\");\n                            String accountid=obj.getString(\"account_number\");\n                            String balance =obj.getString(\"balance\");\n                            tv.setText(\"Your Balance is $\" + balance);\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError{\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }\n\n\n        };\n\n\n\n\n\n        queue.add(stringRequest);\n        queue.getCache().clear();\n\n\n\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "onCreate",
            "return_type": "void",
            "position": {
              "start_line": 27,
              "end_line": 90,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_balanceview);\n        final TextView tv=findViewById(R.id.textView);\n        SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n        final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n        final RequestQueue queue = Volley.newRequestQueue(this);\n        sharedPreferences = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences.getString(\"apiurl\",null);\n        String endpoint=\"/api/balance/view\";\n        String finalurl = url+endpoint;\n\n\n\n        final JsonObjectRequest stringRequest = new JsonObjectRequest(Request.Method.POST, finalurl,null,\n                new Response.Listener<JSONObject>()  {\n                    @Override\n                    public void onResponse(JSONObject response) {\n                        try {\n\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONObject obj = decryptedResponse.getJSONObject(\"data\");\n                            String accountid=obj.getString(\"account_number\");\n                            String balance =obj.getString(\"balance\");\n                            tv.setText(\"Your Balance is $\" + balance);\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError{\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }\n\n\n        };\n\n\n\n\n\n        queue.add(stringRequest);\n        queue.getCache().clear();\n\n\n\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onResponse",
            "return_type": "void",
            "position": {
              "start_line": 44,
              "end_line": 64,
              "start_column": 20,
              "end_column": 21
            },
            "code": "@Override\n                    public void onResponse(JSONObject response) {\n                        try {\n\n                            JSONObject decryptedResponse = new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n\n                            // Check for error message\n                            if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                                Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n                                return;\n                                // This is buggy. Need to call Login activity again if incorrect credentials are given\n                            }\n\n                            JSONObject obj = decryptedResponse.getJSONObject(\"data\");\n                            String accountid=obj.getString(\"account_number\");\n                            String balance =obj.getString(\"balance\");\n                            tv.setText(\"Your Balance is $\" + balance);\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n                    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onErrorResponse",
            "return_type": "void",
            "position": {
              "start_line": 66,
              "end_line": 69,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public void onErrorResponse(VolleyError error) {\n\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getHeaders",
            "return_type": "Map",
            "position": {
              "start_line": 71,
              "end_line": 76,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public Map getHeaders() throws AuthFailureError{\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/SendMoney.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport androidx.annotation.NonNull;\nimport androidx.appcompat.app.AppCompatActivity;\nimport androidx.biometric.BiometricManager;\nimport androidx.biometric.BiometricPrompt;\nimport androidx.core.content.ContextCompat;\n\nimport android.content.Context;\nimport android.content.Intent;\nimport android.content.SharedPreferences;\n\nimport android.os.Bundle;\nimport android.util.Log;\nimport android.view.View;\nimport android.widget.Button;\nimport android.widget.EditText;\nimport android.widget.TextView;\nimport android.widget.Toast;\n\nimport com.android.volley.AuthFailureError;\nimport com.android.volley.Request;\nimport com.android.volley.RequestQueue;\nimport com.android.volley.Response;\nimport com.android.volley.VolleyError;\nimport com.android.volley.toolbox.JsonObjectRequest;\nimport com.android.volley.toolbox.Volley;\n\nimport org.json.JSONException;\nimport org.json.JSONObject;\n\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.util.concurrent.Executor;\n\nimport static com.app.damnvulnerablebank.ViewBeneficiaryAdmin.beneficiary_account_number;\n\npublic class SendMoney extends AppCompatActivity {\n\n    Button send;\n    TextView tt;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_sendmoney);\n        tt=findViewById(R.id.actid);\n        Intent i =getIntent();\n        String p=i.getStringExtra(beneficiary_account_number);\n        tt.setText(p);\n        send=findViewById(R.id.sendbutton);\n    }\n\n\n\n    public void sendMoney(){\n        SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n        final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n        SharedPreferences sharedPreferences1 = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences1.getString(\"apiurl\",null);\n        String endpoint = \"/api/balance/transfer\";\n        final String finalUrl = url+endpoint;\n        EditText ed = findViewById(R.id.edact);\n        EditText ed1 = findViewById(R.id.edamt);\n        int n = 0;\n        int na = 0;\n\n        final RequestQueue requestQueue = Volley.newRequestQueue(getApplicationContext());\n        JSONObject requestData = new JSONObject();\n        JSONObject requestDataEncrypted = new JSONObject();\n        try {\n\n            // fetch values\n            if (ed.getText().toString() != \"\" && ed1.getText().toString() != \"\") {\n                n = Integer.parseInt(ed.getText().toString());\n                na = Integer.parseInt(ed1.getText().toString());\n            } else {\n                Toast.makeText(getApplicationContext(), \"Invalid Input \", Toast.LENGTH_SHORT).show();\n                startActivity(new Intent(SendMoney.this, SendMoney.class));\n            }\n            //input your API parameters\n            requestData.put(\"to_account\",n);\n            requestData.put(\"amount\",na);\n\n            // Encrypt data before sending\n            requestDataEncrypted.put(\"enc_data\", EncryptDecrypt.encrypt(requestData.toString()));\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        // Enter the correct url for your api service site\n        final JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(Request.Method.POST, finalUrl, requestDataEncrypted,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n\n                        JSONObject decryptedResponse =  new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n                        Log.d(\"Send Money\", decryptedResponse.toString());\n\n                        if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                            Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n\n                            return;\n                            // This is buggy. Need to call Login activity again if incorrect credentials are given\n                        }\n\n\n\n                            Toast.makeText(getApplicationContext(),\"\"+EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()), Toast.LENGTH_SHORT).show();\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n\n                        startActivity(new Intent(SendMoney.this, Dashboard.class));\n\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }\n\n\n        };\n        requestQueue.add(jsonObjectRequest);\n\n\n    }\n\n\n\n    public void Biometrics(View view){\n         BiometricManager biometricManager = BiometricManager.from(this);\n        switch (biometricManager.canAuthenticate()){\n\n            case BiometricManager.BIOMETRIC_SUCCESS:\n                Toast.makeText(this,\"Authenticate to continue\",Toast.LENGTH_LONG).show();\n                break;\n            case BiometricManager.BIOMETRIC_ERROR_NO_HARDWARE:\n                Toast.makeText(this,\"No fingerprint sensor\",Toast.LENGTH_LONG).show();\n                send.setVisibility(View.INVISIBLE);\n\n                break;\n            case BiometricManager.BIOMETRIC_ERROR_HW_UNAVAILABLE:\n                Toast.makeText(this,\"Biometric sensor is not available\",Toast.LENGTH_LONG).show();\n                send.setVisibility(View.INVISIBLE);\n\n                break;\n            case BiometricManager.BIOMETRIC_ERROR_NONE_ENROLLED:\n                Toast.makeText(this,\"Your device don't have any fingerprint, check your security setting\",Toast.LENGTH_LONG).show();\n                send.setVisibility(View.INVISIBLE);\n                break;\n        }\n\n        Executor executor = ContextCompat.getMainExecutor(this);\n\n\n        final BiometricPrompt biometricPrompt = new BiometricPrompt(SendMoney.this,executor,new BiometricPrompt.AuthenticationCallback(){\n\n            @Override\n            public void onAuthenticationError(int errorCode, @NonNull CharSequence errString) {\n                super.onAuthenticationError(errorCode, errString);\n            }\n\n            @Override\n            public void onAuthenticationSucceeded(@NonNull BiometricPrompt.AuthenticationResult result) {\n                super.onAuthenticationSucceeded(result);\n                Toast.makeText(getApplicationContext(),\"Transfer Successful\",Toast.LENGTH_LONG).show();\n                sendMoney();\n            }\n\n            @Override\n            public void onAuthenticationFailed() {\n                super.onAuthenticationFailed();\n            }\n        });\n\n        final BiometricPrompt.PromptInfo  promptInfo = new BiometricPrompt.PromptInfo.Builder()\n                .setTitle(\"Login\")\n                .setDescription(\"User fingerprint to Proceed\")\n                .setDeviceCredentialAllowed(true)\n                .build();\n\n\n\n                biometricPrompt.authenticate(promptInfo);\n\n\n\n    }\n\n}",
    "classes": [
      {
        "parent_file": null,
        "name": "SendMoney",
        "position": {
          "start_line": 38,
          "end_line": 201,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class SendMoney extends AppCompatActivity {\n\n    Button send;\n    TextView tt;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_sendmoney);\n        tt=findViewById(R.id.actid);\n        Intent i =getIntent();\n        String p=i.getStringExtra(beneficiary_account_number);\n        tt.setText(p);\n        send=findViewById(R.id.sendbutton);\n    }\n\n\n\n    public void sendMoney(){\n        SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n        final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n        SharedPreferences sharedPreferences1 = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences1.getString(\"apiurl\",null);\n        String endpoint = \"/api/balance/transfer\";\n        final String finalUrl = url+endpoint;\n        EditText ed = findViewById(R.id.edact);\n        EditText ed1 = findViewById(R.id.edamt);\n        int n = 0;\n        int na = 0;\n\n        final RequestQueue requestQueue = Volley.newRequestQueue(getApplicationContext());\n        JSONObject requestData = new JSONObject();\n        JSONObject requestDataEncrypted = new JSONObject();\n        try {\n\n            // fetch values\n            if (ed.getText().toString() != \"\" && ed1.getText().toString() != \"\") {\n                n = Integer.parseInt(ed.getText().toString());\n                na = Integer.parseInt(ed1.getText().toString());\n            } else {\n                Toast.makeText(getApplicationContext(), \"Invalid Input \", Toast.LENGTH_SHORT).show();\n                startActivity(new Intent(SendMoney.this, SendMoney.class));\n            }\n            //input your API parameters\n            requestData.put(\"to_account\",n);\n            requestData.put(\"amount\",na);\n\n            // Encrypt data before sending\n            requestDataEncrypted.put(\"enc_data\", EncryptDecrypt.encrypt(requestData.toString()));\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        // Enter the correct url for your api service site\n        final JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(Request.Method.POST, finalUrl, requestDataEncrypted,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n\n                        JSONObject decryptedResponse =  new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n                        Log.d(\"Send Money\", decryptedResponse.toString());\n\n                        if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                            Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n\n                            return;\n                            // This is buggy. Need to call Login activity again if incorrect credentials are given\n                        }\n\n\n\n                            Toast.makeText(getApplicationContext(),\"\"+EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()), Toast.LENGTH_SHORT).show();\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n\n                        startActivity(new Intent(SendMoney.this, Dashboard.class));\n\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }\n\n\n        };\n        requestQueue.add(jsonObjectRequest);\n\n\n    }\n\n\n\n    public void Biometrics(View view){\n         BiometricManager biometricManager = BiometricManager.from(this);\n        switch (biometricManager.canAuthenticate()){\n\n            case BiometricManager.BIOMETRIC_SUCCESS:\n                Toast.makeText(this,\"Authenticate to continue\",Toast.LENGTH_LONG).show();\n                break;\n            case BiometricManager.BIOMETRIC_ERROR_NO_HARDWARE:\n                Toast.makeText(this,\"No fingerprint sensor\",Toast.LENGTH_LONG).show();\n                send.setVisibility(View.INVISIBLE);\n\n                break;\n            case BiometricManager.BIOMETRIC_ERROR_HW_UNAVAILABLE:\n                Toast.makeText(this,\"Biometric sensor is not available\",Toast.LENGTH_LONG).show();\n                send.setVisibility(View.INVISIBLE);\n\n                break;\n            case BiometricManager.BIOMETRIC_ERROR_NONE_ENROLLED:\n                Toast.makeText(this,\"Your device don't have any fingerprint, check your security setting\",Toast.LENGTH_LONG).show();\n                send.setVisibility(View.INVISIBLE);\n                break;\n        }\n\n        Executor executor = ContextCompat.getMainExecutor(this);\n\n\n        final BiometricPrompt biometricPrompt = new BiometricPrompt(SendMoney.this,executor,new BiometricPrompt.AuthenticationCallback(){\n\n            @Override\n            public void onAuthenticationError(int errorCode, @NonNull CharSequence errString) {\n                super.onAuthenticationError(errorCode, errString);\n            }\n\n            @Override\n            public void onAuthenticationSucceeded(@NonNull BiometricPrompt.AuthenticationResult result) {\n                super.onAuthenticationSucceeded(result);\n                Toast.makeText(getApplicationContext(),\"Transfer Successful\",Toast.LENGTH_LONG).show();\n                sendMoney();\n            }\n\n            @Override\n            public void onAuthenticationFailed() {\n                super.onAuthenticationFailed();\n            }\n        });\n\n        final BiometricPrompt.PromptInfo  promptInfo = new BiometricPrompt.PromptInfo.Builder()\n                .setTitle(\"Login\")\n                .setDescription(\"User fingerprint to Proceed\")\n                .setDeviceCredentialAllowed(true)\n                .build();\n\n\n\n                biometricPrompt.authenticate(promptInfo);\n\n\n\n    }\n\n}",
        "summary": "",
        "methods": [
          {
            "name": "onCreate",
            "return_type": "void",
            "position": {
              "start_line": 43,
              "end_line": 52,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_sendmoney);\n        tt=findViewById(R.id.actid);\n        Intent i =getIntent();\n        String p=i.getStringExtra(beneficiary_account_number);\n        tt.setText(p);\n        send=findViewById(R.id.sendbutton);\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "sendMoney",
            "return_type": "void",
            "position": {
              "start_line": 56,
              "end_line": 137,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void sendMoney(){\n        SharedPreferences sharedPreferences = getSharedPreferences(\"jwt\", Context.MODE_PRIVATE);\n        final String retrivedToken  = sharedPreferences.getString(\"accesstoken\",null);\n        SharedPreferences sharedPreferences1 = getSharedPreferences(\"apiurl\", Context.MODE_PRIVATE);\n        final String url  = sharedPreferences1.getString(\"apiurl\",null);\n        String endpoint = \"/api/balance/transfer\";\n        final String finalUrl = url+endpoint;\n        EditText ed = findViewById(R.id.edact);\n        EditText ed1 = findViewById(R.id.edamt);\n        int n = 0;\n        int na = 0;\n\n        final RequestQueue requestQueue = Volley.newRequestQueue(getApplicationContext());\n        JSONObject requestData = new JSONObject();\n        JSONObject requestDataEncrypted = new JSONObject();\n        try {\n\n            // fetch values\n            if (ed.getText().toString() != \"\" && ed1.getText().toString() != \"\") {\n                n = Integer.parseInt(ed.getText().toString());\n                na = Integer.parseInt(ed1.getText().toString());\n            } else {\n                Toast.makeText(getApplicationContext(), \"Invalid Input \", Toast.LENGTH_SHORT).show();\n                startActivity(new Intent(SendMoney.this, SendMoney.class));\n            }\n            //input your API parameters\n            requestData.put(\"to_account\",n);\n            requestData.put(\"amount\",na);\n\n            // Encrypt data before sending\n            requestDataEncrypted.put(\"enc_data\", EncryptDecrypt.encrypt(requestData.toString()));\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n        // Enter the correct url for your api service site\n        final JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(Request.Method.POST, finalUrl, requestDataEncrypted,\n                new Response.Listener<JSONObject>() {\n                    @Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n\n                        JSONObject decryptedResponse =  new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n                        Log.d(\"Send Money\", decryptedResponse.toString());\n\n                        if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                            Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n\n                            return;\n                            // This is buggy. Need to call Login activity again if incorrect credentials are given\n                        }\n\n\n\n                            Toast.makeText(getApplicationContext(),\"\"+EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()), Toast.LENGTH_SHORT).show();\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n\n                        startActivity(new Intent(SendMoney.this, Dashboard.class));\n\n                    }\n                }, new Response.ErrorListener() {\n            @Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }\n        }){\n            @Override\n            public Map getHeaders() throws AuthFailureError {\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }\n\n\n        };\n        requestQueue.add(jsonObjectRequest);\n\n\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onResponse",
            "return_type": "void",
            "position": {
              "start_line": 93,
              "end_line": 118,
              "start_column": 20,
              "end_column": 21
            },
            "code": "@Override\n                    public void onResponse(JSONObject response) {\n\n                        try {\n\n                        JSONObject decryptedResponse =  new JSONObject(EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()));\n                        Log.d(\"Send Money\", decryptedResponse.toString());\n\n                        if(decryptedResponse.getJSONObject(\"status\").getInt(\"code\") != 200) {\n                            Toast.makeText(getApplicationContext(), \"Error: \" + decryptedResponse.getJSONObject(\"data\").getString(\"message\"), Toast.LENGTH_SHORT).show();\n\n                            return;\n                            // This is buggy. Need to call Login activity again if incorrect credentials are given\n                        }\n\n\n\n                            Toast.makeText(getApplicationContext(),\"\"+EncryptDecrypt.decrypt(response.get(\"enc_data\").toString()), Toast.LENGTH_SHORT).show();\n                        } catch (JSONException e) {\n                            e.printStackTrace();\n                        }\n\n\n                        startActivity(new Intent(SendMoney.this, Dashboard.class));\n\n                    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onErrorResponse",
            "return_type": "void",
            "position": {
              "start_line": 120,
              "end_line": 123,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public void onErrorResponse(VolleyError error) {\n                Toast.makeText(getApplicationContext(), \"Something went wrong\", Toast.LENGTH_SHORT).show();\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getHeaders",
            "return_type": "Map",
            "position": {
              "start_line": 125,
              "end_line": 130,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public Map getHeaders() throws AuthFailureError {\n                HashMap headers=new HashMap();\n                headers.put(\"Authorization\",\"Bearer \"+retrivedToken);\n                return headers;\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "Biometrics",
            "return_type": "void",
            "position": {
              "start_line": 141,
              "end_line": 199,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void Biometrics(View view){\n         BiometricManager biometricManager = BiometricManager.from(this);\n        switch (biometricManager.canAuthenticate()){\n\n            case BiometricManager.BIOMETRIC_SUCCESS:\n                Toast.makeText(this,\"Authenticate to continue\",Toast.LENGTH_LONG).show();\n                break;\n            case BiometricManager.BIOMETRIC_ERROR_NO_HARDWARE:\n                Toast.makeText(this,\"No fingerprint sensor\",Toast.LENGTH_LONG).show();\n                send.setVisibility(View.INVISIBLE);\n\n                break;\n            case BiometricManager.BIOMETRIC_ERROR_HW_UNAVAILABLE:\n                Toast.makeText(this,\"Biometric sensor is not available\",Toast.LENGTH_LONG).show();\n                send.setVisibility(View.INVISIBLE);\n\n                break;\n            case BiometricManager.BIOMETRIC_ERROR_NONE_ENROLLED:\n                Toast.makeText(this,\"Your device don't have any fingerprint, check your security setting\",Toast.LENGTH_LONG).show();\n                send.setVisibility(View.INVISIBLE);\n                break;\n        }\n\n        Executor executor = ContextCompat.getMainExecutor(this);\n\n\n        final BiometricPrompt biometricPrompt = new BiometricPrompt(SendMoney.this,executor,new BiometricPrompt.AuthenticationCallback(){\n\n            @Override\n            public void onAuthenticationError(int errorCode, @NonNull CharSequence errString) {\n                super.onAuthenticationError(errorCode, errString);\n            }\n\n            @Override\n            public void onAuthenticationSucceeded(@NonNull BiometricPrompt.AuthenticationResult result) {\n                super.onAuthenticationSucceeded(result);\n                Toast.makeText(getApplicationContext(),\"Transfer Successful\",Toast.LENGTH_LONG).show();\n                sendMoney();\n            }\n\n            @Override\n            public void onAuthenticationFailed() {\n                super.onAuthenticationFailed();\n            }\n        });\n\n        final BiometricPrompt.PromptInfo  promptInfo = new BiometricPrompt.PromptInfo.Builder()\n                .setTitle(\"Login\")\n                .setDescription(\"User fingerprint to Proceed\")\n                .setDeviceCredentialAllowed(true)\n                .build();\n\n\n\n                biometricPrompt.authenticate(promptInfo);\n\n\n\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onAuthenticationError",
            "return_type": "void",
            "position": {
              "start_line": 169,
              "end_line": 172,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public void onAuthenticationError(int errorCode, @NonNull CharSequence errString) {\n                super.onAuthenticationError(errorCode, errString);\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onAuthenticationSucceeded",
            "return_type": "void",
            "position": {
              "start_line": 174,
              "end_line": 179,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public void onAuthenticationSucceeded(@NonNull BiometricPrompt.AuthenticationResult result) {\n                super.onAuthenticationSucceeded(result);\n                Toast.makeText(getApplicationContext(),\"Transfer Successful\",Toast.LENGTH_LONG).show();\n                sendMoney();\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "onAuthenticationFailed",
            "return_type": "void",
            "position": {
              "start_line": 181,
              "end_line": 184,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public void onAuthenticationFailed() {\n                super.onAuthenticationFailed();\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/EmulatorDetectortest.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport android.os.Build;\nimport android.os.Environment;\nimport android.util.Log;\n\nimport java.io.File;\n\npublic class EmulatorDetectortest {\n    private static final String TAG = \"EmulatorDetector\";\n\n    private static int rating = -1;\n\n    /**\n     * Detects if app is currenly running on emulator, or real device.\n     * @return true for emulator, false for real devices\n     */\n    public static boolean isEmulator() {\n        int newRating = 0;\n        if(rating < 0) {\n            if (Build.PRODUCT.contains(\"sdk\") ||\n                    Build.PRODUCT.contains(\"Andy\") ||\n                    Build.PRODUCT.contains(\"ttVM_Hdragon\") ||\n                    Build.PRODUCT.contains(\"google_sdk\") ||\n                    Build.PRODUCT.contains(\"Droid4X\") ||\n                    Build.PRODUCT.contains(\"nox\") ||\n                    Build.PRODUCT.contains(\"sdk_x86\") ||\n                    Build.PRODUCT.contains(\"sdk_google\") ||\n                    Build.PRODUCT.contains(\"vbox86p\")) {\n                newRating++;\n            }\n\n            if (Build.MANUFACTURER.equals(\"unknown\") ||\n                    Build.MANUFACTURER.equals(\"Genymotion\") ||\n                    Build.MANUFACTURER.contains(\"Andy\") ||\n                    Build.MANUFACTURER.contains(\"MIT\") ||\n                    Build.MANUFACTURER.contains(\"nox\") ||\n                    Build.MANUFACTURER.contains(\"TiantianVM\")){\n                newRating++;\n            }\n\n            if (Build.BRAND.equals(\"generic\") ||\n                    Build.BRAND.equals(\"generic_x86\") ||\n                    Build.BRAND.equals(\"TTVM\") ||\n                    Build.BRAND.contains(\"Andy\")) {\n                newRating++;\n            }\n\n            if (Build.DEVICE.contains(\"generic\") ||\n                    Build.DEVICE.contains(\"generic_x86\") ||\n                    Build.DEVICE.contains(\"Andy\") ||\n                    Build.DEVICE.contains(\"ttVM_Hdragon\") ||\n                    Build.DEVICE.contains(\"Droid4X\") ||\n                    Build.DEVICE.contains(\"nox\") ||\n                    Build.DEVICE.contains(\"generic_x86_64\") ||\n                    Build.DEVICE.contains(\"vbox86p\")) {\n                newRating++;\n            }\n\n            if (Build.MODEL.equals(\"sdk\") ||\n                    Build.MODEL.equals(\"google_sdk\") ||\n                    Build.MODEL.contains(\"Droid4X\") ||\n                    Build.MODEL.contains(\"TiantianVM\") ||\n                    Build.MODEL.contains(\"Andy\") ||\n                    Build.MODEL.equals(\"Android SDK built for x86_64\") ||\n                    Build.MODEL.equals(\"Android SDK built for x86\")) {\n                newRating++;\n            }\n\n            if (Build.HARDWARE.equals(\"goldfish\") ||\n                    Build.HARDWARE.equals(\"vbox86\") ||\n                    Build.HARDWARE.contains(\"nox\") ||\n                    Build.HARDWARE.contains(\"ttVM_x86\")) {\n                newRating++;\n            }\n\n            if (Build.FINGERPRINT.contains(\"generic/sdk/generic\") ||\n                    Build.FINGERPRINT.contains(\"generic_x86/sdk_x86/generic_x86\") ||\n                    Build.FINGERPRINT.contains(\"Andy\") ||\n                    Build.FINGERPRINT.contains(\"ttVM_Hdragon\") ||\n                    Build.FINGERPRINT.contains(\"generic_x86_64\") ||\n                    Build.FINGERPRINT.contains(\"generic/google_sdk/generic\") ||\n                    Build.FINGERPRINT.contains(\"vbox86p\") ||\n                    Build.FINGERPRINT.contains(\"generic/vbox86p/vbox86p\")) {\n                newRating++;\n            }\n\n            try {\n                String opengl = android.opengl.GLES20.glGetString(android.opengl.GLES20.GL_RENDERER);\n                if (opengl != null){\n                    if( opengl.contains(\"Bluestacks\") ||\n                            opengl.contains(\"Translator\")\n                    )\n                        newRating += 10;\n                }\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n\n            try {\n                File sharedFolder = new File(Environment\n                        .getExternalStorageDirectory().toString()\n                        + File.separatorChar\n                        + \"windows\"\n                        + File.separatorChar\n                        + \"BstSharedFolder\");\n\n                if (sharedFolder.exists()) {\n                    newRating += 10;\n                }\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n            rating = newRating;\n        }\n        return rating > 3;\n    }\n\n    /**\n     * Returns string with human-readable listing of Build.* parameters used in {@link #isEmulator()} method.\n     * @return all involved Build.* parameters and its values\n     */\n    public static String getDeviceListing() {\n        return \"Build.PRODUCT: \" + Build.PRODUCT + \"\\n\" +\n                \"Build.MANUFACTURER: \" + Build.MANUFACTURER + \"\\n\" +\n                \"Build.BRAND: \" + Build.BRAND + \"\\n\" +\n                \"Build.DEVICE: \" + Build.DEVICE + \"\\n\" +\n                \"Build.MODEL: \" + Build.MODEL + \"\\n\" +\n                \"Build.HARDWARE: \" + Build.HARDWARE + \"\\n\" +\n                \"Build.FINGERPRINT: \" + Build.FINGERPRINT + \"\\n\" +\n                \"Build.TAGS: \" + Build.TAGS + \"\\n\" +\n                \"GL_RENDERER: \" +android.opengl.GLES20.glGetString(android.opengl.GLES20.GL_RENDERER) + \"\\n\" +\n                \"GL_VENDOR: \" +android.opengl.GLES20.glGetString(android.opengl.GLES20.GL_VENDOR) + \"\\n\" +\n                \"GL_VERSION: \" +android.opengl.GLES20.glGetString(android.opengl.GLES20.GL_VERSION) + \"\\n\" +\n                \"GL_EXTENSIONS: \" +android.opengl.GLES20.glGetString(android.opengl.GLES20.GL_EXTENSIONS) + \"\\n\";\n    }\n\n    /**\n     * Prints all Build.* parameters used in {@link #isEmulator()} method to logcat.\n     */\n    public static void logcat() {\n        Log.d(TAG, getDeviceListing());\n    }\n}\n",
    "classes": [
      {
        "parent_file": null,
        "name": "EmulatorDetectortest",
        "position": {
          "start_line": 9,
          "end_line": 144,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class EmulatorDetectortest {\n    private static final String TAG = \"EmulatorDetector\";\n\n    private static int rating = -1;\n\n    /**\n     * Detects if app is currenly running on emulator, or real device.\n     * @return true for emulator, false for real devices\n     */\n    public static boolean isEmulator() {\n        int newRating = 0;\n        if(rating < 0) {\n            if (Build.PRODUCT.contains(\"sdk\") ||\n                    Build.PRODUCT.contains(\"Andy\") ||\n                    Build.PRODUCT.contains(\"ttVM_Hdragon\") ||\n                    Build.PRODUCT.contains(\"google_sdk\") ||\n                    Build.PRODUCT.contains(\"Droid4X\") ||\n                    Build.PRODUCT.contains(\"nox\") ||\n                    Build.PRODUCT.contains(\"sdk_x86\") ||\n                    Build.PRODUCT.contains(\"sdk_google\") ||\n                    Build.PRODUCT.contains(\"vbox86p\")) {\n                newRating++;\n            }\n\n            if (Build.MANUFACTURER.equals(\"unknown\") ||\n                    Build.MANUFACTURER.equals(\"Genymotion\") ||\n                    Build.MANUFACTURER.contains(\"Andy\") ||\n                    Build.MANUFACTURER.contains(\"MIT\") ||\n                    Build.MANUFACTURER.contains(\"nox\") ||\n                    Build.MANUFACTURER.contains(\"TiantianVM\")){\n                newRating++;\n            }\n\n            if (Build.BRAND.equals(\"generic\") ||\n                    Build.BRAND.equals(\"generic_x86\") ||\n                    Build.BRAND.equals(\"TTVM\") ||\n                    Build.BRAND.contains(\"Andy\")) {\n                newRating++;\n            }\n\n            if (Build.DEVICE.contains(\"generic\") ||\n                    Build.DEVICE.contains(\"generic_x86\") ||\n                    Build.DEVICE.contains(\"Andy\") ||\n                    Build.DEVICE.contains(\"ttVM_Hdragon\") ||\n                    Build.DEVICE.contains(\"Droid4X\") ||\n                    Build.DEVICE.contains(\"nox\") ||\n                    Build.DEVICE.contains(\"generic_x86_64\") ||\n                    Build.DEVICE.contains(\"vbox86p\")) {\n                newRating++;\n            }\n\n            if (Build.MODEL.equals(\"sdk\") ||\n                    Build.MODEL.equals(\"google_sdk\") ||\n                    Build.MODEL.contains(\"Droid4X\") ||\n                    Build.MODEL.contains(\"TiantianVM\") ||\n                    Build.MODEL.contains(\"Andy\") ||\n                    Build.MODEL.equals(\"Android SDK built for x86_64\") ||\n                    Build.MODEL.equals(\"Android SDK built for x86\")) {\n                newRating++;\n            }\n\n            if (Build.HARDWARE.equals(\"goldfish\") ||\n                    Build.HARDWARE.equals(\"vbox86\") ||\n                    Build.HARDWARE.contains(\"nox\") ||\n                    Build.HARDWARE.contains(\"ttVM_x86\")) {\n                newRating++;\n            }\n\n            if (Build.FINGERPRINT.contains(\"generic/sdk/generic\") ||\n                    Build.FINGERPRINT.contains(\"generic_x86/sdk_x86/generic_x86\") ||\n                    Build.FINGERPRINT.contains(\"Andy\") ||\n                    Build.FINGERPRINT.contains(\"ttVM_Hdragon\") ||\n                    Build.FINGERPRINT.contains(\"generic_x86_64\") ||\n                    Build.FINGERPRINT.contains(\"generic/google_sdk/generic\") ||\n                    Build.FINGERPRINT.contains(\"vbox86p\") ||\n                    Build.FINGERPRINT.contains(\"generic/vbox86p/vbox86p\")) {\n                newRating++;\n            }\n\n            try {\n                String opengl = android.opengl.GLES20.glGetString(android.opengl.GLES20.GL_RENDERER);\n                if (opengl != null){\n                    if( opengl.contains(\"Bluestacks\") ||\n                            opengl.contains(\"Translator\")\n                    )\n                        newRating += 10;\n                }\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n\n            try {\n                File sharedFolder = new File(Environment\n                        .getExternalStorageDirectory().toString()\n                        + File.separatorChar\n                        + \"windows\"\n                        + File.separatorChar\n                        + \"BstSharedFolder\");\n\n                if (sharedFolder.exists()) {\n                    newRating += 10;\n                }\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n            rating = newRating;\n        }\n        return rating > 3;\n    }\n\n    /**\n     * Returns string with human-readable listing of Build.* parameters used in {@link #isEmulator()} method.\n     * @return all involved Build.* parameters and its values\n     */\n    public static String getDeviceListing() {\n        return \"Build.PRODUCT: \" + Build.PRODUCT + \"\\n\" +\n                \"Build.MANUFACTURER: \" + Build.MANUFACTURER + \"\\n\" +\n                \"Build.BRAND: \" + Build.BRAND + \"\\n\" +\n                \"Build.DEVICE: \" + Build.DEVICE + \"\\n\" +\n                \"Build.MODEL: \" + Build.MODEL + \"\\n\" +\n                \"Build.HARDWARE: \" + Build.HARDWARE + \"\\n\" +\n                \"Build.FINGERPRINT: \" + Build.FINGERPRINT + \"\\n\" +\n                \"Build.TAGS: \" + Build.TAGS + \"\\n\" +\n                \"GL_RENDERER: \" +android.opengl.GLES20.glGetString(android.opengl.GLES20.GL_RENDERER) + \"\\n\" +\n                \"GL_VENDOR: \" +android.opengl.GLES20.glGetString(android.opengl.GLES20.GL_VENDOR) + \"\\n\" +\n                \"GL_VERSION: \" +android.opengl.GLES20.glGetString(android.opengl.GLES20.GL_VERSION) + \"\\n\" +\n                \"GL_EXTENSIONS: \" +android.opengl.GLES20.glGetString(android.opengl.GLES20.GL_EXTENSIONS) + \"\\n\";\n    }\n\n    /**\n     * Prints all Build.* parameters used in {@link #isEmulator()} method to logcat.\n     */\n    public static void logcat() {\n        Log.d(TAG, getDeviceListing());\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "isEmulator",
            "return_type": "boolean",
            "position": {
              "start_line": 18,
              "end_line": 117,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public static boolean isEmulator() {\n        int newRating = 0;\n        if(rating < 0) {\n            if (Build.PRODUCT.contains(\"sdk\") ||\n                    Build.PRODUCT.contains(\"Andy\") ||\n                    Build.PRODUCT.contains(\"ttVM_Hdragon\") ||\n                    Build.PRODUCT.contains(\"google_sdk\") ||\n                    Build.PRODUCT.contains(\"Droid4X\") ||\n                    Build.PRODUCT.contains(\"nox\") ||\n                    Build.PRODUCT.contains(\"sdk_x86\") ||\n                    Build.PRODUCT.contains(\"sdk_google\") ||\n                    Build.PRODUCT.contains(\"vbox86p\")) {\n                newRating++;\n            }\n\n            if (Build.MANUFACTURER.equals(\"unknown\") ||\n                    Build.MANUFACTURER.equals(\"Genymotion\") ||\n                    Build.MANUFACTURER.contains(\"Andy\") ||\n                    Build.MANUFACTURER.contains(\"MIT\") ||\n                    Build.MANUFACTURER.contains(\"nox\") ||\n                    Build.MANUFACTURER.contains(\"TiantianVM\")){\n                newRating++;\n            }\n\n            if (Build.BRAND.equals(\"generic\") ||\n                    Build.BRAND.equals(\"generic_x86\") ||\n                    Build.BRAND.equals(\"TTVM\") ||\n                    Build.BRAND.contains(\"Andy\")) {\n                newRating++;\n            }\n\n            if (Build.DEVICE.contains(\"generic\") ||\n                    Build.DEVICE.contains(\"generic_x86\") ||\n                    Build.DEVICE.contains(\"Andy\") ||\n                    Build.DEVICE.contains(\"ttVM_Hdragon\") ||\n                    Build.DEVICE.contains(\"Droid4X\") ||\n                    Build.DEVICE.contains(\"nox\") ||\n                    Build.DEVICE.contains(\"generic_x86_64\") ||\n                    Build.DEVICE.contains(\"vbox86p\")) {\n                newRating++;\n            }\n\n            if (Build.MODEL.equals(\"sdk\") ||\n                    Build.MODEL.equals(\"google_sdk\") ||\n                    Build.MODEL.contains(\"Droid4X\") ||\n                    Build.MODEL.contains(\"TiantianVM\") ||\n                    Build.MODEL.contains(\"Andy\") ||\n                    Build.MODEL.equals(\"Android SDK built for x86_64\") ||\n                    Build.MODEL.equals(\"Android SDK built for x86\")) {\n                newRating++;\n            }\n\n            if (Build.HARDWARE.equals(\"goldfish\") ||\n                    Build.HARDWARE.equals(\"vbox86\") ||\n                    Build.HARDWARE.contains(\"nox\") ||\n                    Build.HARDWARE.contains(\"ttVM_x86\")) {\n                newRating++;\n            }\n\n            if (Build.FINGERPRINT.contains(\"generic/sdk/generic\") ||\n                    Build.FINGERPRINT.contains(\"generic_x86/sdk_x86/generic_x86\") ||\n                    Build.FINGERPRINT.contains(\"Andy\") ||\n                    Build.FINGERPRINT.contains(\"ttVM_Hdragon\") ||\n                    Build.FINGERPRINT.contains(\"generic_x86_64\") ||\n                    Build.FINGERPRINT.contains(\"generic/google_sdk/generic\") ||\n                    Build.FINGERPRINT.contains(\"vbox86p\") ||\n                    Build.FINGERPRINT.contains(\"generic/vbox86p/vbox86p\")) {\n                newRating++;\n            }\n\n            try {\n                String opengl = android.opengl.GLES20.glGetString(android.opengl.GLES20.GL_RENDERER);\n                if (opengl != null){\n                    if( opengl.contains(\"Bluestacks\") ||\n                            opengl.contains(\"Translator\")\n                    )\n                        newRating += 10;\n                }\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n\n            try {\n                File sharedFolder = new File(Environment\n                        .getExternalStorageDirectory().toString()\n                        + File.separatorChar\n                        + \"windows\"\n                        + File.separatorChar\n                        + \"BstSharedFolder\");\n\n                if (sharedFolder.exists()) {\n                    newRating += 10;\n                }\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n            rating = newRating;\n        }\n        return rating > 3;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getDeviceListing",
            "return_type": "String",
            "position": {
              "start_line": 123,
              "end_line": 136,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public static String getDeviceListing() {\n        return \"Build.PRODUCT: \" + Build.PRODUCT + \"\\n\" +\n                \"Build.MANUFACTURER: \" + Build.MANUFACTURER + \"\\n\" +\n                \"Build.BRAND: \" + Build.BRAND + \"\\n\" +\n                \"Build.DEVICE: \" + Build.DEVICE + \"\\n\" +\n                \"Build.MODEL: \" + Build.MODEL + \"\\n\" +\n                \"Build.HARDWARE: \" + Build.HARDWARE + \"\\n\" +\n                \"Build.FINGERPRINT: \" + Build.FINGERPRINT + \"\\n\" +\n                \"Build.TAGS: \" + Build.TAGS + \"\\n\" +\n                \"GL_RENDERER: \" +android.opengl.GLES20.glGetString(android.opengl.GLES20.GL_RENDERER) + \"\\n\" +\n                \"GL_VENDOR: \" +android.opengl.GLES20.glGetString(android.opengl.GLES20.GL_VENDOR) + \"\\n\" +\n                \"GL_VERSION: \" +android.opengl.GLES20.glGetString(android.opengl.GLES20.GL_VERSION) + \"\\n\" +\n                \"GL_EXTENSIONS: \" +android.opengl.GLES20.glGetString(android.opengl.GLES20.GL_EXTENSIONS) + \"\\n\";\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "logcat",
            "return_type": "void",
            "position": {
              "start_line": 141,
              "end_line": 143,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public static void logcat() {\n        Log.d(TAG, getDeviceListing());\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/FridaCheckJNI.java",
    "code": "package com.app.damnvulnerablebank;\n\npublic class FridaCheckJNI {\n    private static final String soName =  \"frida-check\";\n\n    static\n    {\n        System.loadLibrary(soName);\n    }\n\n    public native int fridaCheck();\n}\n",
    "classes": [
      {
        "parent_file": null,
        "name": "FridaCheckJNI",
        "position": {
          "start_line": 3,
          "end_line": 12,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class FridaCheckJNI {\n    private static final String soName =  \"frida-check\";\n\n    static\n    {\n        System.loadLibrary(soName);\n    }\n\n    public native int fridaCheck();\n}",
        "summary": "",
        "methods": [
          {
            "name": "fridaCheck",
            "return_type": "int",
            "position": {
              "start_line": 11,
              "end_line": 11,
              "start_column": 4,
              "end_column": 35
            },
            "code": "public native int fridaCheck();",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/PendingBeneficiaryRecords.java",
    "code": "package com.app.damnvulnerablebank;\n\npublic class PendingBeneficiaryRecords {\n    private String account_number;\n    private String beneficiary_account_number;\n    private String id;\n\n    public PendingBeneficiaryRecords(){}\n\n    public String getAccountNumber() {\n        return account_number;\n    }\n\n    public void setAccountNumber(String account_number) {\n        this.account_number = \"Account Number\\t\\t:\"+account_number;\n    }\n\n    public String getBeneficiaryAccountNumber() {\n        return beneficiary_account_number;\n    }\n\n    public void setBeneficiaryAccountNumber(String beneficiary_account_number) {\n        this.beneficiary_account_number = \"Benificiary Account Number\\t\\t:\"+beneficiary_account_number+\"\\n\";\n    }\n\n    public String getId() {\n        return id;\n    }\n\n    public void setId(String id) {\n        this.id = \"ID\\t\\t:\" + id;\n    }\n\n    public PendingBeneficiaryRecords(String account_number, String    beneficiary_account_number, String idd){}\n\n}\n",
    "classes": [
      {
        "parent_file": null,
        "name": "PendingBeneficiaryRecords",
        "position": {
          "start_line": 3,
          "end_line": 36,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class PendingBeneficiaryRecords {\n    private String account_number;\n    private String beneficiary_account_number;\n    private String id;\n\n    public PendingBeneficiaryRecords(){}\n\n    public String getAccountNumber() {\n        return account_number;\n    }\n\n    public void setAccountNumber(String account_number) {\n        this.account_number = \"Account Number\\t\\t:\"+account_number;\n    }\n\n    public String getBeneficiaryAccountNumber() {\n        return beneficiary_account_number;\n    }\n\n    public void setBeneficiaryAccountNumber(String beneficiary_account_number) {\n        this.beneficiary_account_number = \"Benificiary Account Number\\t\\t:\"+beneficiary_account_number+\"\\n\";\n    }\n\n    public String getId() {\n        return id;\n    }\n\n    public void setId(String id) {\n        this.id = \"ID\\t\\t:\" + id;\n    }\n\n    public PendingBeneficiaryRecords(String account_number, String    beneficiary_account_number, String idd){}\n\n}",
        "summary": "",
        "methods": [
          {
            "name": "getAccountNumber",
            "return_type": "String",
            "position": {
              "start_line": 10,
              "end_line": 12,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public String getAccountNumber() {\n        return account_number;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "setAccountNumber",
            "return_type": "void",
            "position": {
              "start_line": 14,
              "end_line": 16,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void setAccountNumber(String account_number) {\n        this.account_number = \"Account Number\\t\\t:\"+account_number;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getBeneficiaryAccountNumber",
            "return_type": "String",
            "position": {
              "start_line": 18,
              "end_line": 20,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public String getBeneficiaryAccountNumber() {\n        return beneficiary_account_number;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "setBeneficiaryAccountNumber",
            "return_type": "void",
            "position": {
              "start_line": 22,
              "end_line": 24,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void setBeneficiaryAccountNumber(String beneficiary_account_number) {\n        this.beneficiary_account_number = \"Benificiary Account Number\\t\\t:\"+beneficiary_account_number+\"\\n\";\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "getId",
            "return_type": "String",
            "position": {
              "start_line": 26,
              "end_line": 28,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public String getId() {\n        return id;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "setId",
            "return_type": "void",
            "position": {
              "start_line": 30,
              "end_line": 32,
              "start_column": 4,
              "end_column": 5
            },
            "code": "public void setId(String id) {\n        this.id = \"ID\\t\\t:\" + id;\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/SplashScreen.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport android.content.Intent;\nimport android.os.Bundle;\nimport android.os.Handler;\nimport android.view.Window;\nimport android.view.WindowManager;\nimport android.view.animation.Animation;\nimport android.view.animation.AnimationUtils;\nimport android.widget.ImageView;\nimport android.widget.TextView;\n\npublic class SplashScreen extends AppCompatActivity {\n\n    private static int SPLASH_TIMER= 3000;\n\n    ImageView backgroundiimage;\n    TextView txt;\n    Animation sideAnim, bottomAnim;\n\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        this.requestWindowFeature(Window.FEATURE_NO_TITLE);\n        this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);\n        this.setContentView(R.layout.splash_screen);\n\n\n\n        backgroundiimage =findViewById(R.id.background_image);\n        txt =findViewById(R.id.powered);\n\n        sideAnim = AnimationUtils.loadAnimation(this,R.anim.side_anim);\n        bottomAnim = AnimationUtils.loadAnimation(this,R.anim.bottom_anim);\n\n        backgroundiimage.setAnimation(sideAnim);\n        txt.setAnimation(bottomAnim);\n\n        new Handler().postDelayed(new Runnable() {\n            @Override\n            public void run() {\n                Intent intent =new Intent(getApplicationContext(), MainActivity.class);\n                startActivity(intent);\n                finish();\n            }\n        },SPLASH_TIMER);\n    }\n}",
    "classes": [
      {
        "parent_file": null,
        "name": "SplashScreen",
        "position": {
          "start_line": 15,
          "end_line": 51,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class SplashScreen extends AppCompatActivity {\n\n    private static int SPLASH_TIMER= 3000;\n\n    ImageView backgroundiimage;\n    TextView txt;\n    Animation sideAnim, bottomAnim;\n\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        this.requestWindowFeature(Window.FEATURE_NO_TITLE);\n        this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);\n        this.setContentView(R.layout.splash_screen);\n\n\n\n        backgroundiimage =findViewById(R.id.background_image);\n        txt =findViewById(R.id.powered);\n\n        sideAnim = AnimationUtils.loadAnimation(this,R.anim.side_anim);\n        bottomAnim = AnimationUtils.loadAnimation(this,R.anim.bottom_anim);\n\n        backgroundiimage.setAnimation(sideAnim);\n        txt.setAnimation(bottomAnim);\n\n        new Handler().postDelayed(new Runnable() {\n            @Override\n            public void run() {\n                Intent intent =new Intent(getApplicationContext(), MainActivity.class);\n                startActivity(intent);\n                finish();\n            }\n        },SPLASH_TIMER);\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "onCreate",
            "return_type": "void",
            "position": {
              "start_line": 24,
              "end_line": 50,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        this.requestWindowFeature(Window.FEATURE_NO_TITLE);\n        this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);\n        this.setContentView(R.layout.splash_screen);\n\n\n\n        backgroundiimage =findViewById(R.id.background_image);\n        txt =findViewById(R.id.powered);\n\n        sideAnim = AnimationUtils.loadAnimation(this,R.anim.side_anim);\n        bottomAnim = AnimationUtils.loadAnimation(this,R.anim.bottom_anim);\n\n        backgroundiimage.setAnimation(sideAnim);\n        txt.setAnimation(bottomAnim);\n\n        new Handler().postDelayed(new Runnable() {\n            @Override\n            public void run() {\n                Intent intent =new Intent(getApplicationContext(), MainActivity.class);\n                startActivity(intent);\n                finish();\n            }\n        },SPLASH_TIMER);\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          },
          {
            "name": "run",
            "return_type": "void",
            "position": {
              "start_line": 43,
              "end_line": 48,
              "start_column": 12,
              "end_column": 13
            },
            "code": "@Override\n            public void run() {\n                Intent intent =new Intent(getApplicationContext(), MainActivity.class);\n                startActivity(intent);\n                finish();\n            }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  },
  {
    "path": "/Users/panagiotisbinikos/Desktop/CB_Thesis/code/CB_N/data/apps/Damn-Vulnerable-Bank/DamnVulnerableBank/app/src/main/java/com/app/damnvulnerablebank/CurrencyRates.java",
    "code": "package com.app.damnvulnerablebank;\n\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport android.app.Activity;\nimport android.os.Bundle;\nimport android.webkit.WebChromeClient;\nimport android.webkit.WebSettings;\nimport android.webkit.WebView;\nimport android.webkit.WebViewClient;\n\npublic class CurrencyRates extends AppCompatActivity {\n    String getToken;\n\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_currencyrates);\n        Bundle extras = getIntent().getExtras();\n        if(extras == null){\n            WebView vulnerable =(WebView) findViewById(R.id.loads);\n            WebSettings webSettings = vulnerable.getSettings();\n            webSettings.setJavaScriptEnabled(true);\n            vulnerable.setWebChromeClient(new WebChromeClient());\n            WebViewClientImpl webViewClient = new WebViewClientImpl(this);\n            vulnerable.setWebViewClient(webViewClient);\n            vulnerable.loadUrl(\"https://www.xe.com/\"); }\n\n        else{\n            getToken =getIntent().getData().getQueryParameter(\"url\");\n            WebView vulnerable =(WebView) findViewById(R.id.loads);\n            WebSettings webSettings = vulnerable.getSettings();\n            webSettings.setJavaScriptEnabled(true);\n            vulnerable.setWebChromeClient(new WebChromeClient());\n            WebViewClientImpl webViewClient = new WebViewClientImpl(this);\n            vulnerable.setWebViewClient(webViewClient);\n            vulnerable.loadUrl(getToken);}\n    }\n}\n\n\n\nclass WebViewClientImpl extends WebViewClient {\n\n    private Activity activity = null;\n\n    public WebViewClientImpl(Activity activity) {\n        this.activity = activity;\n    }\n\n    @Override\n    public boolean shouldOverrideUrlLoading(WebView webView, String url) {\n        return false;\n\n    }\n\n}",
    "classes": [
      {
        "parent_file": null,
        "name": "CurrencyRates",
        "position": {
          "start_line": 12,
          "end_line": 40,
          "start_column": 0,
          "end_column": 1
        },
        "code": "public class CurrencyRates extends AppCompatActivity {\n    String getToken;\n\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_currencyrates);\n        Bundle extras = getIntent().getExtras();\n        if(extras == null){\n            WebView vulnerable =(WebView) findViewById(R.id.loads);\n            WebSettings webSettings = vulnerable.getSettings();\n            webSettings.setJavaScriptEnabled(true);\n            vulnerable.setWebChromeClient(new WebChromeClient());\n            WebViewClientImpl webViewClient = new WebViewClientImpl(this);\n            vulnerable.setWebViewClient(webViewClient);\n            vulnerable.loadUrl(\"https://www.xe.com/\"); }\n\n        else{\n            getToken =getIntent().getData().getQueryParameter(\"url\");\n            WebView vulnerable =(WebView) findViewById(R.id.loads);\n            WebSettings webSettings = vulnerable.getSettings();\n            webSettings.setJavaScriptEnabled(true);\n            vulnerable.setWebChromeClient(new WebChromeClient());\n            WebViewClientImpl webViewClient = new WebViewClientImpl(this);\n            vulnerable.setWebViewClient(webViewClient);\n            vulnerable.loadUrl(getToken);}\n    }\n}",
        "summary": "",
        "methods": [
          {
            "name": "onCreate",
            "return_type": "void",
            "position": {
              "start_line": 16,
              "end_line": 39,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_currencyrates);\n        Bundle extras = getIntent().getExtras();\n        if(extras == null){\n            WebView vulnerable =(WebView) findViewById(R.id.loads);\n            WebSettings webSettings = vulnerable.getSettings();\n            webSettings.setJavaScriptEnabled(true);\n            vulnerable.setWebChromeClient(new WebChromeClient());\n            WebViewClientImpl webViewClient = new WebViewClientImpl(this);\n            vulnerable.setWebViewClient(webViewClient);\n            vulnerable.loadUrl(\"https://www.xe.com/\"); }\n\n        else{\n            getToken =getIntent().getData().getQueryParameter(\"url\");\n            WebView vulnerable =(WebView) findViewById(R.id.loads);\n            WebSettings webSettings = vulnerable.getSettings();\n            webSettings.setJavaScriptEnabled(true);\n            vulnerable.setWebChromeClient(new WebChromeClient());\n            WebViewClientImpl webViewClient = new WebViewClientImpl(this);\n            vulnerable.setWebViewClient(webViewClient);\n            vulnerable.loadUrl(getToken);}\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      },
      {
        "parent_file": null,
        "name": "WebViewClientImpl",
        "position": {
          "start_line": 44,
          "end_line": 58,
          "start_column": 0,
          "end_column": 1
        },
        "code": "class WebViewClientImpl extends WebViewClient {\n\n    private Activity activity = null;\n\n    public WebViewClientImpl(Activity activity) {\n        this.activity = activity;\n    }\n\n    @Override\n    public boolean shouldOverrideUrlLoading(WebView webView, String url) {\n        return false;\n\n    }\n\n}",
        "summary": "",
        "methods": [
          {
            "name": "shouldOverrideUrlLoading",
            "return_type": "boolean",
            "position": {
              "start_line": 52,
              "end_line": 56,
              "start_column": 4,
              "end_column": 5
            },
            "code": "@Override\n    public boolean shouldOverrideUrlLoading(WebView webView, String url) {\n        return false;\n\n    }",
            "summary": "",
            "cluster_summary": "",
            "parent": null,
            "parent_cluster": null,
            "is_false_positive": null,
            "is_vulnerable": false,
            "vulnerability_metadata": null,
            "vulnerability": null,
            "matched_string": "",
            "parameters": []
          }
        ]
      }
    ]
  }
]